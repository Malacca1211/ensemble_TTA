[24/06/18 22:23:26] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_222326
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 22:23:26] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:23:26] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:23:26] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:23:26] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:25:08] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_222508
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 22:25:08] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:25:08] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:25:08] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:25:08] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:25:26] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 59.64%
[24/06/18 22:25:41] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 54.02%
[24/06/18 22:25:57] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.81%
[24/06/18 22:26:13] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.47%
[24/06/18 22:26:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 53.31%
[24/06/18 22:26:44] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.43%
[24/06/18 22:27:00] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 32.39%
[24/06/18 22:27:15] [cifar100c_all_resemble.py:  404]: error % [snow5]: 41.07%
[24/06/18 22:27:31] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.69%
[24/06/18 22:27:46] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.79%
[24/06/18 22:28:02] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.53%
[24/06/18 22:28:18] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.67%
[24/06/18 22:28:33] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 43.57%
[24/06/18 22:28:49] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 37.26%
[24/06/18 22:29:04] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 48.78%
[24/06/18 22:29:04] [cifar100c_all_resemble.py:  419]: error % [mean5]: 42.76%
[24/06/18 22:29:20] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 46.71%
[24/06/18 22:29:35] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.98%
[24/06/18 22:29:51] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.77%
[24/06/18 22:30:06] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.70%
[24/06/18 22:30:21] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.65%
[24/06/18 22:30:37] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 37.10%
[24/06/18 22:30:52] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 33.07%
[24/06/18 22:31:08] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.80%
[24/06/18 22:31:23] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.92%
[24/06/18 22:32:46] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_223246
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 22:32:46] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:32:46] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:32:46] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:32:46] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:32:47] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:33:51] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.13%
[24/06/18 22:34:52] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.41%
[24/06/18 22:35:53] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.05%
[24/06/18 22:36:54] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 29.31%
[24/06/18 22:37:55] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.66%
[24/06/18 22:38:56] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 30.80%
[24/06/18 22:39:57] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 27.86%
[24/06/18 22:40:59] [cifar100c_all_resemble.py:  404]: error % [snow5]: 35.98%
[24/06/18 22:42:00] [cifar100c_all_resemble.py:  404]: error % [frost5]: 34.81%
[24/06/18 22:43:02] [cifar100c_all_resemble.py:  404]: error % [fog5]: 33.35%
[24/06/18 22:44:03] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 25.50%
[24/06/18 22:45:04] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 30.75%
[24/06/18 22:46:05] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 37.66%
[24/06/18 22:47:06] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 32.32%
[24/06/18 22:48:08] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.60%
[24/06/18 22:48:08] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.08%
[24/06/18 22:50:39] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_225039
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 22:50:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 22:50:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 22:50:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 22:50:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/18 22:50:57] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.07%
[24/06/18 22:51:13] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.80%
[24/06/18 22:51:28] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.54%
[24/06/18 22:51:44] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.62%
[24/06/18 22:52:01] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.31%
[24/06/18 22:52:17] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.47%
[24/06/18 22:52:32] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.72%
[24/06/18 22:52:48] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.12%
[24/06/18 22:53:04] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.88%
[24/06/18 22:53:20] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.06%
[24/06/18 22:53:35] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.20%
[24/06/18 22:53:51] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.23%
[24/06/18 22:54:07] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.95%
[24/06/18 22:54:23] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.36%
[24/06/18 22:54:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.60%
[24/06/18 22:54:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.46%
[24/06/18 23:05:09] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_230509
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:05:09] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:05:09] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 23:05:09] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:05:09] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:05:27] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 57.35%
[24/06/18 23:05:43] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 54.61%
[24/06/18 23:05:58] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 59.25%
[24/06/18 23:06:13] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.32%
[24/06/18 23:06:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.42%
[24/06/18 23:06:44] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.40%
[24/06/18 23:06:59] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 32.02%
[24/06/18 23:07:15] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.62%
[24/06/18 23:07:30] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.43%
[24/06/18 23:07:45] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.41%
[24/06/18 23:08:00] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.35%
[24/06/18 23:08:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.09%
[24/06/18 23:08:31] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.18%
[24/06/18 23:08:46] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.83%
[24/06/18 23:09:01] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.88%
[24/06/18 23:09:01] [cifar100c_all_resemble.py:  419]: error % [mean5]: 42.14%
[24/06/18 23:09:04] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_230904
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:09:04] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:09:04] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 23:09:04] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:09:04] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:09:22] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 57.35%
[24/06/18 23:09:37] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 54.60%
[24/06/18 23:09:52] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 59.24%
[24/06/18 23:10:08] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.31%
[24/06/18 23:10:23] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.44%
[24/06/18 23:10:38] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.38%
[24/06/18 23:10:53] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 32.02%
[24/06/18 23:11:09] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.61%
[24/06/18 23:11:24] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.41%
[24/06/18 23:11:39] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.41%
[24/06/18 23:11:54] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.34%
[24/06/18 23:12:10] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.07%
[24/06/18 23:12:25] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.14%
[24/06/18 23:12:40] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.85%
[24/06/18 23:12:55] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.85%
[24/06/18 23:12:55] [cifar100c_all_resemble.py:  419]: error % [mean5]: 42.13%
[24/06/18 23:12:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_231258
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:12:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:12:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/18 23:12:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:12:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:13:20] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.90%
[24/06/18 23:13:39] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.05%
[24/06/18 23:13:57] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.60%
[24/06/18 23:14:16] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.77%
[24/06/18 23:14:35] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.05%
[24/06/18 23:14:54] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.79%
[24/06/18 23:15:12] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.84%
[24/06/18 23:15:31] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.78%
[24/06/18 23:15:50] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.90%
[24/06/18 23:16:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.21%
[24/06/18 23:16:27] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.62%
[24/06/18 23:16:46] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.09%
[24/06/18 23:17:05] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.05%
[24/06/18 23:17:23] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.19%
[24/06/18 23:17:42] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.39%
[24/06/18 23:17:42] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.88%
[24/06/18 23:17:45] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_231745
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:17:45] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:17:45] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/18 23:17:45] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:17:45] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:18:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.90%
[24/06/18 23:18:26] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.03%
[24/06/18 23:18:44] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.59%
[24/06/18 23:19:03] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.77%
[24/06/18 23:19:22] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.04%
[24/06/18 23:19:40] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.77%
[24/06/18 23:19:59] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.87%
[24/06/18 23:20:18] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.76%
[24/06/18 23:20:37] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.93%
[24/06/18 23:20:56] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.21%
[24/06/18 23:21:14] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.61%
[24/06/18 23:21:33] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.09%
[24/06/18 23:21:52] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.10%
[24/06/18 23:22:10] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.22%
[24/06/18 23:22:29] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.36%
[24/06/18 23:22:29] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.88%
[24/06/18 23:22:32] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_232232
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:22:32] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:22:32] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/18 23:22:32] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:22:32] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:22:57] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.50%
[24/06/18 23:23:19] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.35%
[24/06/18 23:23:41] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.74%
[24/06/18 23:24:03] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.02%
[24/06/18 23:24:25] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.75%
[24/06/18 23:24:47] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.87%
[24/06/18 23:25:09] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.55%
[24/06/18 23:25:31] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.46%
[24/06/18 23:25:52] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.43%
[24/06/18 23:26:14] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.10%
[24/06/18 23:26:36] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.21%
[24/06/18 23:26:58] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.36%
[24/06/18 23:27:20] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.65%
[24/06/18 23:27:42] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.58%
[24/06/18 23:28:04] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.38%
[24/06/18 23:28:04] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.80%
[24/06/18 23:28:07] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_232807
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:28:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:28:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/18 23:28:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:28:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:28:32] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.49%
[24/06/18 23:28:54] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.35%
[24/06/18 23:29:16] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.74%
[24/06/18 23:29:38] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.99%
[24/06/18 23:30:00] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.72%
[24/06/18 23:30:22] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.88%
[24/06/18 23:30:43] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.55%
[24/06/18 23:31:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.44%
[24/06/18 23:31:27] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.45%
[24/06/18 23:31:49] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.12%
[24/06/18 23:32:11] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.20%
[24/06/18 23:32:33] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.38%
[24/06/18 23:32:55] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.66%
[24/06/18 23:33:17] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.60%
[24/06/18 23:33:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.38%
[24/06/18 23:33:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.80%
[24/06/18 23:33:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_233342
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:33:44] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_233344
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:33:47] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_233347
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:33:48] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:33:48] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 23:33:48] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:33:48] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00011
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:34:05] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 57.04%
[24/06/18 23:34:21] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 54.37%
[24/06/18 23:34:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.99%
[24/06/18 23:34:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.25%
[24/06/18 23:35:06] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.17%
[24/06/18 23:35:22] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.44%
[24/06/18 23:35:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.98%
[24/06/18 23:35:52] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.52%
[24/06/18 23:36:07] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.37%
[24/06/18 23:36:23] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.28%
[24/06/18 23:36:38] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.35%
[24/06/18 23:36:53] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.07%
[24/06/18 23:37:08] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.16%
[24/06/18 23:37:23] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.58%
[24/06/18 23:37:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.47%
[24/06/18 23:37:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 42.00%
[24/06/18 23:37:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_233742
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:37:42] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:37:42] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/18 23:37:42] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:37:42] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00011
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:38:00] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 57.03%
[24/06/18 23:38:15] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 54.38%
[24/06/18 23:38:30] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.99%
[24/06/18 23:38:45] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.27%
[24/06/18 23:39:01] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.22%
[24/06/18 23:39:16] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.41%
[24/06/18 23:39:31] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.96%
[24/06/18 23:39:46] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.51%
[24/06/18 23:40:01] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.35%
[24/06/18 23:40:17] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.24%
[24/06/18 23:40:32] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.33%
[24/06/18 23:40:47] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.05%
[24/06/18 23:41:02] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.17%
[24/06/18 23:41:18] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.62%
[24/06/18 23:41:33] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.50%
[24/06/18 23:41:33] [cifar100c_all_resemble.py:  419]: error % [mean5]: 42.00%
[24/06/18 23:41:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_234136
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:41:36] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:41:36] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/18 23:41:36] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:41:36] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00011
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:41:57] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.77%
[24/06/18 23:42:16] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.59%
[24/06/18 23:42:35] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.18%
[24/06/18 23:42:54] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.89%
[24/06/18 23:43:12] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.93%
[24/06/18 23:43:31] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.80%
[24/06/18 23:43:50] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.80%
[24/06/18 23:44:09] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.71%
[24/06/18 23:44:27] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.78%
[24/06/18 23:44:46] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.35%
[24/06/18 23:45:05] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.63%
[24/06/18 23:45:24] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.03%
[24/06/18 23:45:42] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.00%
[24/06/18 23:46:01] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.13%
[24/06/18 23:46:20] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.22%
[24/06/18 23:46:20] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.79%
[24/06/18 23:46:23] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_234623
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:46:23] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:46:23] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/18 23:46:23] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:46:23] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00011
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:46:44] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.78%
[24/06/18 23:47:03] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.60%
[24/06/18 23:47:22] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.17%
[24/06/18 23:47:41] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.85%
[24/06/18 23:48:00] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.96%
[24/06/18 23:48:18] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.77%
[24/06/18 23:48:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.83%
[24/06/18 23:48:56] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.71%
[24/06/18 23:49:15] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.77%
[24/06/18 23:49:33] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.35%
[24/06/18 23:49:52] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.61%
[24/06/18 23:50:11] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.04%
[24/06/18 23:50:30] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.01%
[24/06/18 23:50:48] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.15%
[24/06/18 23:51:07] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.25%
[24/06/18 23:51:07] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.79%
[24/06/18 23:51:10] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_235110
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:51:11] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:51:11] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/18 23:51:11] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:51:11] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00011
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:51:35] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.38%
[24/06/18 23:51:57] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.12%
[24/06/18 23:52:19] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.39%
[24/06/18 23:52:41] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.99%
[24/06/18 23:53:03] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.59%
[24/06/18 23:53:25] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.07%
[24/06/18 23:53:47] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.70%
[24/06/18 23:54:09] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.41%
[24/06/18 23:54:31] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.23%
[24/06/18 23:54:53] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.95%
[24/06/18 23:55:15] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.25%
[24/06/18 23:55:37] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.51%
[24/06/18 23:55:59] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.60%
[24/06/18 23:56:21] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.25%
[24/06/18 23:56:43] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.18%
[24/06/18 23:56:43] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.71%
[24/06/18 23:56:46] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240618_235646
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/18 23:56:46] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/18 23:56:46] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/18 23:56:46] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/18 23:56:46] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00011
    maximize: False
    weight_decay: 0.0
)
[24/06/18 23:57:11] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.36%
[24/06/18 23:57:32] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.12%
[24/06/18 23:57:54] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.39%
[24/06/18 23:58:16] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.99%
[24/06/18 23:58:38] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.59%
[24/06/18 23:59:00] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.08%
[24/06/18 23:59:22] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.66%
[24/06/18 23:59:44] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.41%
[24/06/19 00:00:06] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.20%
[24/06/19 00:00:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.95%
[24/06/19 00:00:50] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.24%
[24/06/19 00:01:12] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.45%
[24/06/19 00:01:34] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.59%
[24/06/19 00:01:56] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.27%
[24/06/19 00:02:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.13%
[24/06/19 00:02:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.70%
[24/06/19 00:02:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_000221
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:02:23] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_000223
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:02:26] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_000226
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:02:27] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:02:27] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 00:02:27] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:02:27] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:02:44] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.98%
[24/06/19 00:03:00] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.99%
[24/06/19 00:03:15] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.55%
[24/06/19 00:03:30] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.24%
[24/06/19 00:03:45] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.06%
[24/06/19 00:04:00] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.45%
[24/06/19 00:04:16] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.99%
[24/06/19 00:04:31] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.43%
[24/06/19 00:04:46] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.32%
[24/06/19 00:05:01] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.09%
[24/06/19 00:05:17] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.47%
[24/06/19 00:05:32] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.06%
[24/06/19 00:05:47] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.11%
[24/06/19 00:06:02] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.39%
[24/06/19 00:06:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.19%
[24/06/19 00:06:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.89%
[24/06/19 00:06:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_000621
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:06:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:06:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 00:06:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:06:21] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:06:38] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 57.01%
[24/06/19 00:06:54] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 54.00%
[24/06/19 00:07:09] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.58%
[24/06/19 00:07:24] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.25%
[24/06/19 00:07:39] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.08%
[24/06/19 00:07:55] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.45%
[24/06/19 00:08:10] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.97%
[24/06/19 00:08:25] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.43%
[24/06/19 00:08:40] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.30%
[24/06/19 00:08:55] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.10%
[24/06/19 00:09:11] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.47%
[24/06/19 00:09:26] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.06%
[24/06/19 00:09:41] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 00:09:56] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.42%
[24/06/19 00:10:12] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.24%
[24/06/19 00:10:12] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.90%
[24/06/19 00:10:15] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_001015
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:10:15] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:10:15] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 00:10:15] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:10:15] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:10:36] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.61%
[24/06/19 00:10:55] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.16%
[24/06/19 00:11:14] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.73%
[24/06/19 00:11:33] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.96%
[24/06/19 00:11:51] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.72%
[24/06/19 00:12:10] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.74%
[24/06/19 00:12:29] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.80%
[24/06/19 00:12:48] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.74%
[24/06/19 00:13:07] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.58%
[24/06/19 00:13:25] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.49%
[24/06/19 00:13:44] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.73%
[24/06/19 00:14:03] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.99%
[24/06/19 00:14:22] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.85%
[24/06/19 00:14:40] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.14%
[24/06/19 00:14:59] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.15%
[24/06/19 00:14:59] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.69%
[24/06/19 00:15:02] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_001502
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:15:02] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:15:02] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 00:15:02] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:15:02] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:15:24] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.59%
[24/06/19 00:15:42] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.16%
[24/06/19 00:16:01] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.70%
[24/06/19 00:16:20] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.93%
[24/06/19 00:16:39] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.76%
[24/06/19 00:16:57] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.79%
[24/06/19 00:17:16] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.78%
[24/06/19 00:17:35] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.70%
[24/06/19 00:17:54] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.57%
[24/06/19 00:18:12] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.50%
[24/06/19 00:18:31] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.75%
[24/06/19 00:18:50] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.98%
[24/06/19 00:19:09] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.85%
[24/06/19 00:19:27] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.16%
[24/06/19 00:19:46] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.16%
[24/06/19 00:19:46] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.69%
[24/06/19 00:19:49] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_001949
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:19:49] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:19:49] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 00:19:49] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:19:49] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:20:14] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.19%
[24/06/19 00:20:36] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.94%
[24/06/19 00:20:58] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.01%
[24/06/19 00:21:20] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.09%
[24/06/19 00:21:42] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.38%
[24/06/19 00:22:04] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.20%
[24/06/19 00:22:26] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.67%
[24/06/19 00:22:48] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.38%
[24/06/19 00:23:10] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.95%
[24/06/19 00:23:31] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.97%
[24/06/19 00:23:53] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.23%
[24/06/19 00:24:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.53%
[24/06/19 00:24:37] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.55%
[24/06/19 00:24:59] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.21%
[24/06/19 00:25:21] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.98%
[24/06/19 00:25:21] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.62%
[24/06/19 00:25:24] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_002524
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:25:24] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:25:24] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 00:25:24] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:25:24] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00012
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:25:49] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.16%
[24/06/19 00:26:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.92%
[24/06/19 00:26:33] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.04%
[24/06/19 00:26:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.12%
[24/06/19 00:27:17] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.41%
[24/06/19 00:27:39] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.23%
[24/06/19 00:28:01] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.67%
[24/06/19 00:28:22] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.38%
[24/06/19 00:28:44] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.95%
[24/06/19 00:29:06] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.00%
[24/06/19 00:29:28] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.23%
[24/06/19 00:29:50] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.53%
[24/06/19 00:30:12] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.54%
[24/06/19 00:30:34] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.23%
[24/06/19 00:30:56] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.98%
[24/06/19 00:30:56] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.63%
[24/06/19 00:30:59] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_003059
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:31:02] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_003102
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:31:05] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_003105
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:31:05] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:31:05] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 00:31:05] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:31:05] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00013
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:31:22] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.97%
[24/06/19 00:31:38] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.85%
[24/06/19 00:31:53] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.24%
[24/06/19 00:32:08] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.22%
[24/06/19 00:32:23] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.05%
[24/06/19 00:32:39] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.40%
[24/06/19 00:32:54] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.87%
[24/06/19 00:33:09] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.35%
[24/06/19 00:33:24] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.22%
[24/06/19 00:33:40] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.07%
[24/06/19 00:33:55] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.73%
[24/06/19 00:34:10] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.06%
[24/06/19 00:34:25] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.03%
[24/06/19 00:34:41] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.39%
[24/06/19 00:34:56] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.07%
[24/06/19 00:34:56] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.83%
[24/06/19 00:34:59] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_003459
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:34:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:34:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 00:34:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:34:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00013
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:35:17] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.93%
[24/06/19 00:35:32] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.85%
[24/06/19 00:35:47] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 58.25%
[24/06/19 00:36:03] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.22%
[24/06/19 00:36:18] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.04%
[24/06/19 00:36:33] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.40%
[24/06/19 00:36:48] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.90%
[24/06/19 00:37:03] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.38%
[24/06/19 00:37:19] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.22%
[24/06/19 00:37:34] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.06%
[24/06/19 00:37:49] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.74%
[24/06/19 00:38:04] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.08%
[24/06/19 00:38:20] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.01%
[24/06/19 00:38:35] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.39%
[24/06/19 00:38:50] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.03%
[24/06/19 00:38:50] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.83%
[24/06/19 00:38:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_003853
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:38:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:38:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 00:38:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:38:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00013
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:39:15] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.40%
[24/06/19 00:39:33] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.80%
[24/06/19 00:39:52] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.21%
[24/06/19 00:40:11] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.94%
[24/06/19 00:40:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.46%
[24/06/19 00:40:48] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.83%
[24/06/19 00:41:07] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.71%
[24/06/19 00:41:26] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.62%
[24/06/19 00:41:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.28%
[24/06/19 00:42:03] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.46%
[24/06/19 00:42:22] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.75%
[24/06/19 00:42:41] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.16%
[24/06/19 00:43:00] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.89%
[24/06/19 00:43:18] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.17%
[24/06/19 00:43:37] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.15%
[24/06/19 00:43:37] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.59%
[24/06/19 00:43:40] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_004340
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:43:40] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:43:40] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 00:43:40] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:43:40] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00013
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:44:01] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.41%
[24/06/19 00:44:20] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.78%
[24/06/19 00:44:39] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.22%
[24/06/19 00:44:58] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.91%
[24/06/19 00:45:16] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.47%
[24/06/19 00:45:35] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.83%
[24/06/19 00:45:54] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.70%
[24/06/19 00:46:13] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.61%
[24/06/19 00:46:31] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.33%
[24/06/19 00:46:50] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.47%
[24/06/19 00:47:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.74%
[24/06/19 00:47:28] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.18%
[24/06/19 00:47:46] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.88%
[24/06/19 00:48:05] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.12%
[24/06/19 00:48:24] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.17%
[24/06/19 00:48:24] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.59%
[24/06/19 00:48:27] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_004827
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:48:27] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:48:27] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 00:48:27] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:48:27] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00013
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:48:52] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.01%
[24/06/19 00:49:14] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.57%
[24/06/19 00:49:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.60%
[24/06/19 00:49:58] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.17%
[24/06/19 00:50:20] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.19%
[24/06/19 00:50:42] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.31%
[24/06/19 00:51:04] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.56%
[24/06/19 00:51:25] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.36%
[24/06/19 00:51:47] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.95%
[24/06/19 00:52:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.90%
[24/06/19 00:52:31] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.25%
[24/06/19 00:52:53] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.62%
[24/06/19 00:53:15] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.55%
[24/06/19 00:53:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.09%
[24/06/19 00:53:59] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.93%
[24/06/19 00:53:59] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.54%
[24/06/19 00:54:02] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_005402
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:54:02] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:54:02] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 00:54:02] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:54:02] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00013
    maximize: False
    weight_decay: 0.0
)
[24/06/19 00:54:27] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.01%
[24/06/19 00:54:49] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.58%
[24/06/19 00:55:11] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.61%
[24/06/19 00:55:33] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.20%
[24/06/19 00:55:55] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.20%
[24/06/19 00:56:17] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.29%
[24/06/19 00:56:39] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.53%
[24/06/19 00:57:01] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.35%
[24/06/19 00:57:23] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.90%
[24/06/19 00:57:45] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.92%
[24/06/19 00:58:07] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.23%
[24/06/19 00:58:29] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.59%
[24/06/19 00:58:50] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.53%
[24/06/19 00:59:12] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.08%
[24/06/19 00:59:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.93%
[24/06/19 00:59:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.53%
[24/06/19 00:59:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_005937
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:59:40] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_005940
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:59:43] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_005943
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 00:59:43] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 00:59:43] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 00:59:43] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 00:59:43] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00014
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:00:01] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.83%
[24/06/19 01:00:16] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.58%
[24/06/19 01:00:31] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.95%
[24/06/19 01:00:47] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.20%
[24/06/19 01:01:02] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.95%
[24/06/19 01:01:17] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.48%
[24/06/19 01:01:32] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.91%
[24/06/19 01:01:48] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.38%
[24/06/19 01:02:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.21%
[24/06/19 01:02:18] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.89%
[24/06/19 01:02:33] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.85%
[24/06/19 01:02:49] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.07%
[24/06/19 01:03:04] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.02%
[24/06/19 01:03:19] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.36%
[24/06/19 01:03:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.01%
[24/06/19 01:03:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.78%
[24/06/19 01:03:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_010337
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:03:37] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:03:37] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 01:03:37] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:03:37] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00014
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:03:55] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.82%
[24/06/19 01:04:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.57%
[24/06/19 01:04:26] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.99%
[24/06/19 01:04:41] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.21%
[24/06/19 01:04:56] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.93%
[24/06/19 01:05:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.48%
[24/06/19 01:05:27] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.94%
[24/06/19 01:05:42] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.43%
[24/06/19 01:05:57] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.21%
[24/06/19 01:06:13] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.88%
[24/06/19 01:06:28] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.82%
[24/06/19 01:06:43] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.12%
[24/06/19 01:06:58] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.02%
[24/06/19 01:07:14] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.36%
[24/06/19 01:07:29] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.01%
[24/06/19 01:07:29] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.79%
[24/06/19 01:07:32] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_010732
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:07:32] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:07:32] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 01:07:32] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:07:32] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00014
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:07:53] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.22%
[24/06/19 01:08:12] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.46%
[24/06/19 01:08:31] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.75%
[24/06/19 01:08:49] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.09%
[24/06/19 01:09:08] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.31%
[24/06/19 01:09:27] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.84%
[24/06/19 01:09:46] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.67%
[24/06/19 01:10:04] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.62%
[24/06/19 01:10:23] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.02%
[24/06/19 01:10:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.51%
[24/06/19 01:11:00] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.87%
[24/06/19 01:11:19] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.13%
[24/06/19 01:11:38] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.74%
[24/06/19 01:11:56] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.09%
[24/06/19 01:12:15] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.12%
[24/06/19 01:12:15] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.50%
[24/06/19 01:12:18] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_011218
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:12:18] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:12:18] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 01:12:18] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:12:18] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00014
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:12:40] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.22%
[24/06/19 01:12:59] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.46%
[24/06/19 01:13:17] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.76%
[24/06/19 01:13:36] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.10%
[24/06/19 01:13:55] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.34%
[24/06/19 01:14:14] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.83%
[24/06/19 01:14:32] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.69%
[24/06/19 01:14:51] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.59%
[24/06/19 01:15:10] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.08%
[24/06/19 01:15:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.51%
[24/06/19 01:15:47] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.83%
[24/06/19 01:16:06] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.12%
[24/06/19 01:16:25] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.74%
[24/06/19 01:16:43] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.06%
[24/06/19 01:17:02] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.13%
[24/06/19 01:17:02] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.50%
[24/06/19 01:17:05] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_011705
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:17:05] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:17:05] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 01:17:05] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:17:05] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00014
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:17:30] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.86%
[24/06/19 01:17:52] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.14%
[24/06/19 01:18:14] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.31%
[24/06/19 01:18:36] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.36%
[24/06/19 01:18:58] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.12%
[24/06/19 01:19:20] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.30%
[24/06/19 01:19:42] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.57%
[24/06/19 01:20:04] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.33%
[24/06/19 01:20:25] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.03%
[24/06/19 01:20:47] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.07%
[24/06/19 01:21:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.39%
[24/06/19 01:21:31] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.60%
[24/06/19 01:21:53] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.49%
[24/06/19 01:22:15] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.09%
[24/06/19 01:22:37] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.93%
[24/06/19 01:22:37] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.51%
[24/06/19 01:22:40] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_012240
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:22:40] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:22:40] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 01:22:40] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:22:40] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00014
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:23:05] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.85%
[24/06/19 01:23:27] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.15%
[24/06/19 01:23:49] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.30%
[24/06/19 01:24:11] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.36%
[24/06/19 01:24:33] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.14%
[24/06/19 01:24:55] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.29%
[24/06/19 01:25:17] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.57%
[24/06/19 01:25:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.37%
[24/06/19 01:26:01] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.00%
[24/06/19 01:26:22] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.05%
[24/06/19 01:26:44] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.39%
[24/06/19 01:27:06] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.61%
[24/06/19 01:27:28] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.47%
[24/06/19 01:27:50] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.07%
[24/06/19 01:28:12] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.92%
[24/06/19 01:28:12] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.50%
[24/06/19 01:28:15] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_012815
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:28:18] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_012818
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:28:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_012821
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:28:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:28:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 01:28:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:28:21] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:28:39] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.72%
[24/06/19 01:28:54] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.31%
[24/06/19 01:29:09] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.86%
[24/06/19 01:29:24] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.37%
[24/06/19 01:29:40] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.79%
[24/06/19 01:29:55] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.52%
[24/06/19 01:30:10] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.89%
[24/06/19 01:30:25] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.28%
[24/06/19 01:30:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.16%
[24/06/19 01:30:56] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.00%
[24/06/19 01:31:11] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.00%
[24/06/19 01:31:26] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.11%
[24/06/19 01:31:42] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.03%
[24/06/19 01:31:57] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.46%
[24/06/19 01:32:12] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.91%
[24/06/19 01:32:12] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.76%
[24/06/19 01:32:15] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_013215
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:32:15] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:32:15] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 01:32:15] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:32:15] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:32:33] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.73%
[24/06/19 01:32:48] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 53.33%
[24/06/19 01:33:04] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.86%
[24/06/19 01:33:19] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.38%
[24/06/19 01:33:34] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.81%
[24/06/19 01:33:49] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.48%
[24/06/19 01:34:05] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.89%
[24/06/19 01:34:20] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.28%
[24/06/19 01:34:35] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.18%
[24/06/19 01:34:50] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.94%
[24/06/19 01:35:06] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.00%
[24/06/19 01:35:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.14%
[24/06/19 01:35:36] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.04%
[24/06/19 01:35:51] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.41%
[24/06/19 01:36:07] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.95%
[24/06/19 01:36:07] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.76%
[24/06/19 01:36:10] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_013610
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:36:10] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:36:10] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 01:36:10] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:36:10] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:36:31] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.13%
[24/06/19 01:36:50] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.09%
[24/06/19 01:37:09] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.35%
[24/06/19 01:37:27] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.09%
[24/06/19 01:37:46] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.18%
[24/06/19 01:38:05] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.88%
[24/06/19 01:38:23] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.61%
[24/06/19 01:38:42] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.48%
[24/06/19 01:39:01] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.91%
[24/06/19 01:39:20] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.59%
[24/06/19 01:39:38] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.83%
[24/06/19 01:39:57] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.00%
[24/06/19 01:40:16] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.72%
[24/06/19 01:40:35] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.92%
[24/06/19 01:40:53] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.89%
[24/06/19 01:40:53] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.38%
[24/06/19 01:40:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_014056
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:40:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:40:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 01:40:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:40:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:41:18] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.13%
[24/06/19 01:41:37] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.09%
[24/06/19 01:41:55] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.33%
[24/06/19 01:42:14] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.09%
[24/06/19 01:42:33] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.19%
[24/06/19 01:42:52] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.87%
[24/06/19 01:43:10] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.60%
[24/06/19 01:43:29] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.48%
[24/06/19 01:43:48] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.93%
[24/06/19 01:44:07] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.64%
[24/06/19 01:44:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.83%
[24/06/19 01:44:44] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.00%
[24/06/19 01:45:03] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.70%
[24/06/19 01:45:22] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.93%
[24/06/19 01:45:40] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.93%
[24/06/19 01:45:40] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.38%
[24/06/19 01:45:43] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_014543
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:45:44] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:45:44] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 01:45:44] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:45:44] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:46:08] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.70%
[24/06/19 01:46:30] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.97%
[24/06/19 01:46:52] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.05%
[24/06/19 01:47:14] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.40%
[24/06/19 01:47:36] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.92%
[24/06/19 01:47:58] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.44%
[24/06/19 01:48:20] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.61%
[24/06/19 01:48:42] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.19%
[24/06/19 01:49:04] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.09%
[24/06/19 01:49:26] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.07%
[24/06/19 01:49:48] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.51%
[24/06/19 01:50:10] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.72%
[24/06/19 01:50:32] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.48%
[24/06/19 01:50:54] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.10%
[24/06/19 01:51:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.93%
[24/06/19 01:51:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.48%
[24/06/19 01:51:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_015121
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:51:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:51:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 01:51:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:51:21] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:51:45] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.72%
[24/06/19 01:52:07] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.98%
[24/06/19 01:52:29] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.08%
[24/06/19 01:52:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.40%
[24/06/19 01:53:13] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.91%
[24/06/19 01:53:35] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.40%
[24/06/19 01:53:57] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.64%
[24/06/19 01:54:19] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.18%
[24/06/19 01:54:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.05%
[24/06/19 01:55:03] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.10%
[24/06/19 01:55:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.51%
[24/06/19 01:55:47] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.69%
[24/06/19 01:56:09] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.45%
[24/06/19 01:56:31] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.13%
[24/06/19 01:56:53] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.93%
[24/06/19 01:56:53] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.48%
[24/06/19 01:56:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_015656
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:56:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_015658
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:57:01] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_015701
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 01:57:02] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 01:57:02] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 01:57:02] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 01:57:02] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 01:57:19] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.46%
[24/06/19 01:57:35] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.91%
[24/06/19 01:57:50] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.71%
[24/06/19 01:58:05] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.41%
[24/06/19 01:58:20] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.81%
[24/06/19 01:58:36] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.50%
[24/06/19 01:58:51] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.95%
[24/06/19 01:59:06] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.20%
[24/06/19 01:59:21] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.12%
[24/06/19 01:59:36] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.14%
[24/06/19 01:59:52] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.93%
[24/06/19 02:00:07] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.08%
[24/06/19 02:00:22] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 02:00:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.38%
[24/06/19 02:00:53] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.78%
[24/06/19 02:00:53] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.70%
[24/06/19 02:00:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_020056
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:00:56] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:00:56] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 02:00:56] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:00:56] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:01:14] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.48%
[24/06/19 02:01:29] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.91%
[24/06/19 02:01:44] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.69%
[24/06/19 02:01:59] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.39%
[24/06/19 02:02:15] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.79%
[24/06/19 02:02:30] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.49%
[24/06/19 02:02:45] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.89%
[24/06/19 02:03:00] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.20%
[24/06/19 02:03:16] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.10%
[24/06/19 02:03:31] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.09%
[24/06/19 02:03:46] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.91%
[24/06/19 02:04:01] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.09%
[24/06/19 02:04:16] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.07%
[24/06/19 02:04:32] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.37%
[24/06/19 02:04:47] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.82%
[24/06/19 02:04:47] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.69%
[24/06/19 02:04:50] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_020450
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:04:50] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:04:50] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 02:04:50] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:04:50] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:05:11] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.02%
[24/06/19 02:05:30] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.72%
[24/06/19 02:05:49] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.93%
[24/06/19 02:06:08] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.20%
[24/06/19 02:06:26] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.04%
[24/06/19 02:06:45] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.95%
[24/06/19 02:07:04] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.55%
[24/06/19 02:07:23] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.37%
[24/06/19 02:07:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.94%
[24/06/19 02:08:00] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.51%
[24/06/19 02:08:19] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.84%
[24/06/19 02:08:38] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.09%
[24/06/19 02:08:56] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.77%
[24/06/19 02:09:15] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.95%
[24/06/19 02:09:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.90%
[24/06/19 02:09:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.32%
[24/06/19 02:09:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_020937
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:09:37] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:09:37] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 02:09:37] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:09:37] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:09:58] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.02%
[24/06/19 02:10:17] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.73%
[24/06/19 02:10:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.96%
[24/06/19 02:10:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.20%
[24/06/19 02:11:13] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.04%
[24/06/19 02:11:32] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.92%
[24/06/19 02:11:51] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.52%
[24/06/19 02:12:10] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.35%
[24/06/19 02:12:28] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.96%
[24/06/19 02:12:47] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.50%
[24/06/19 02:13:06] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.82%
[24/06/19 02:13:25] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.09%
[24/06/19 02:13:43] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.78%
[24/06/19 02:14:02] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.96%
[24/06/19 02:14:21] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.85%
[24/06/19 02:14:21] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.31%
[24/06/19 02:14:24] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_021424
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:14:24] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:14:24] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 02:14:24] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:14:24] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:14:49] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.61%
[24/06/19 02:15:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.70%
[24/06/19 02:15:33] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.74%
[24/06/19 02:15:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.57%
[24/06/19 02:16:17] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.62%
[24/06/19 02:16:39] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.52%
[24/06/19 02:17:01] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.58%
[24/06/19 02:17:23] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.17%
[24/06/19 02:17:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.97%
[24/06/19 02:18:07] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.00%
[24/06/19 02:18:28] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.42%
[24/06/19 02:18:50] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.53%
[24/06/19 02:19:12] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.42%
[24/06/19 02:19:34] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.02%
[24/06/19 02:19:56] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.72%
[24/06/19 02:19:56] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.37%
[24/06/19 02:19:59] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_021959
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:20:00] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:20:00] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 02:20:00] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:20:00] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:20:24] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.61%
[24/06/19 02:20:46] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.70%
[24/06/19 02:21:08] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.74%
[24/06/19 02:21:30] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.55%
[24/06/19 02:21:52] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.67%
[24/06/19 02:22:14] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.51%
[24/06/19 02:22:36] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.58%
[24/06/19 02:22:58] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.18%
[24/06/19 02:23:20] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.98%
[24/06/19 02:23:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.05%
[24/06/19 02:24:04] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.41%
[24/06/19 02:24:26] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.55%
[24/06/19 02:24:48] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.40%
[24/06/19 02:25:10] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.02%
[24/06/19 02:25:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.69%
[24/06/19 02:25:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.38%
[24/06/19 02:25:34] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_022534
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:25:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_022537
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:25:40] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_022540
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:25:40] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:25:40] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 02:25:40] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:25:40] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:25:58] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.37%
[24/06/19 02:26:13] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.75%
[24/06/19 02:26:29] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.40%
[24/06/19 02:26:44] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.52%
[24/06/19 02:26:59] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.62%
[24/06/19 02:27:14] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.58%
[24/06/19 02:27:30] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.90%
[24/06/19 02:27:45] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.12%
[24/06/19 02:28:00] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.02%
[24/06/19 02:28:15] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.19%
[24/06/19 02:28:31] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.97%
[24/06/19 02:28:46] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.03%
[24/06/19 02:29:01] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 02:29:16] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.35%
[24/06/19 02:29:32] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.67%
[24/06/19 02:29:32] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.64%
[24/06/19 02:29:35] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_022935
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:29:35] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:29:35] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 02:29:35] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:29:35] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:29:52] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.38%
[24/06/19 02:30:08] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.74%
[24/06/19 02:30:23] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.39%
[24/06/19 02:30:38] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.47%
[24/06/19 02:30:53] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.62%
[24/06/19 02:31:09] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.55%
[24/06/19 02:31:24] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.89%
[24/06/19 02:31:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.07%
[24/06/19 02:31:54] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.96%
[24/06/19 02:32:10] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.23%
[24/06/19 02:32:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.07%
[24/06/19 02:32:40] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.05%
[24/06/19 02:32:55] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.09%
[24/06/19 02:33:11] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.32%
[24/06/19 02:33:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.64%
[24/06/19 02:33:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.63%
[24/06/19 02:33:29] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_023329
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:33:29] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:33:29] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 02:33:29] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:33:29] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:33:50] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.86%
[24/06/19 02:34:09] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.37%
[24/06/19 02:34:28] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.62%
[24/06/19 02:34:47] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.21%
[24/06/19 02:35:05] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.92%
[24/06/19 02:35:24] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.92%
[24/06/19 02:35:43] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.54%
[24/06/19 02:36:02] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.31%
[24/06/19 02:36:21] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.86%
[24/06/19 02:36:40] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.48%
[24/06/19 02:36:58] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.94%
[24/06/19 02:37:17] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.09%
[24/06/19 02:37:36] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.93%
[24/06/19 02:37:55] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.94%
[24/06/19 02:38:13] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.81%
[24/06/19 02:38:13] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.25%
[24/06/19 02:38:16] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_023816
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:38:17] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:38:17] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 02:38:17] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:38:17] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:38:38] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.87%
[24/06/19 02:38:57] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.37%
[24/06/19 02:39:15] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.61%
[24/06/19 02:39:34] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.23%
[24/06/19 02:39:53] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.93%
[24/06/19 02:40:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.94%
[24/06/19 02:40:30] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.53%
[24/06/19 02:40:49] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.31%
[24/06/19 02:41:08] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.84%
[24/06/19 02:41:26] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.50%
[24/06/19 02:41:45] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.94%
[24/06/19 02:42:04] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.07%
[24/06/19 02:42:23] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.96%
[24/06/19 02:42:42] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.94%
[24/06/19 02:43:00] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.81%
[24/06/19 02:43:00] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.26%
[24/06/19 02:43:03] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_024303
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:43:04] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:43:04] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 02:43:04] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:43:04] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:43:28] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.49%
[24/06/19 02:43:50] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.42%
[24/06/19 02:44:12] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.48%
[24/06/19 02:44:34] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.65%
[24/06/19 02:44:56] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.51%
[24/06/19 02:45:18] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.72%
[24/06/19 02:45:40] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.63%
[24/06/19 02:46:02] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.18%
[24/06/19 02:46:24] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.96%
[24/06/19 02:46:46] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.02%
[24/06/19 02:47:08] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.35%
[24/06/19 02:47:30] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.55%
[24/06/19 02:47:52] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.24%
[24/06/19 02:48:14] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.91%
[24/06/19 02:48:36] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.71%
[24/06/19 02:48:36] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.32%
[24/06/19 02:48:39] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_024839
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:48:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:48:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 02:48:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:48:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:49:04] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.48%
[24/06/19 02:49:25] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.41%
[24/06/19 02:49:47] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.49%
[24/06/19 02:50:09] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.63%
[24/06/19 02:50:31] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.57%
[24/06/19 02:50:53] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.70%
[24/06/19 02:51:15] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.66%
[24/06/19 02:51:37] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.24%
[24/06/19 02:51:59] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.99%
[24/06/19 02:52:21] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.00%
[24/06/19 02:52:43] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.35%
[24/06/19 02:53:05] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.55%
[24/06/19 02:53:27] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.24%
[24/06/19 02:53:49] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.95%
[24/06/19 02:54:11] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.66%
[24/06/19 02:54:11] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.33%
[24/06/19 02:54:14] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_025414
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:54:16] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_025416
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:54:19] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_025419
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:54:20] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:54:20] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 02:54:20] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:54:20] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:54:37] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.32%
[24/06/19 02:54:52] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.49%
[24/06/19 02:55:08] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.17%
[24/06/19 02:55:23] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.46%
[24/06/19 02:55:38] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.56%
[24/06/19 02:55:53] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.55%
[24/06/19 02:56:09] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.78%
[24/06/19 02:56:24] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.13%
[24/06/19 02:56:39] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.88%
[24/06/19 02:56:54] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.17%
[24/06/19 02:57:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.12%
[24/06/19 02:57:25] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.09%
[24/06/19 02:57:40] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.04%
[24/06/19 02:57:55] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.35%
[24/06/19 02:58:10] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.61%
[24/06/19 02:58:10] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.58%
[24/06/19 02:58:13] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_025813
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 02:58:14] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 02:58:14] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 02:58:14] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 02:58:14] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 02:58:31] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.31%
[24/06/19 02:58:47] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.44%
[24/06/19 02:59:02] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.11%
[24/06/19 02:59:17] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.41%
[24/06/19 02:59:32] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.54%
[24/06/19 02:59:48] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.57%
[24/06/19 03:00:03] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.78%
[24/06/19 03:00:18] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.12%
[24/06/19 03:00:33] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.88%
[24/06/19 03:00:49] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.12%
[24/06/19 03:01:04] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.06%
[24/06/19 03:01:19] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.10%
[24/06/19 03:01:34] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.09%
[24/06/19 03:01:50] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.36%
[24/06/19 03:02:05] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.63%
[24/06/19 03:02:05] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.57%
[24/06/19 03:02:08] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_030208
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:02:08] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:02:08] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 03:02:08] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:02:08] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:02:29] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.76%
[24/06/19 03:02:48] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.04%
[24/06/19 03:03:07] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.27%
[24/06/19 03:03:26] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.25%
[24/06/19 03:03:44] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.90%
[24/06/19 03:04:03] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.06%
[24/06/19 03:04:22] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.67%
[24/06/19 03:04:41] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.37%
[24/06/19 03:04:59] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.74%
[24/06/19 03:05:18] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.49%
[24/06/19 03:05:37] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.93%
[24/06/19 03:05:56] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.14%
[24/06/19 03:06:14] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.90%
[24/06/19 03:06:33] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.89%
[24/06/19 03:06:52] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.73%
[24/06/19 03:06:52] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.21%
[24/06/19 03:06:55] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_030655
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:06:55] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:06:55] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 03:06:55] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:06:55] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:07:16] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.76%
[24/06/19 03:07:35] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.05%
[24/06/19 03:07:54] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.31%
[24/06/19 03:08:13] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.26%
[24/06/19 03:08:31] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.91%
[24/06/19 03:08:50] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.04%
[24/06/19 03:09:09] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.68%
[24/06/19 03:09:28] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.37%
[24/06/19 03:09:46] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.74%
[24/06/19 03:10:05] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.50%
[24/06/19 03:10:24] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.97%
[24/06/19 03:10:43] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.15%
[24/06/19 03:11:01] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.88%
[24/06/19 03:11:20] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.92%
[24/06/19 03:11:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.75%
[24/06/19 03:11:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.22%
[24/06/19 03:11:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_031142
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:11:42] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:11:42] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 03:11:42] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:11:42] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:12:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.39%
[24/06/19 03:12:29] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.09%
[24/06/19 03:12:51] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.19%
[24/06/19 03:13:13] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.78%
[24/06/19 03:13:35] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.49%
[24/06/19 03:13:57] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.81%
[24/06/19 03:14:19] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.75%
[24/06/19 03:14:41] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.17%
[24/06/19 03:15:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.86%
[24/06/19 03:15:25] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.03%
[24/06/19 03:15:46] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.44%
[24/06/19 03:16:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.64%
[24/06/19 03:16:30] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.28%
[24/06/19 03:16:52] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.16%
[24/06/19 03:17:14] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.83%
[24/06/19 03:17:14] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.33%
[24/06/19 03:17:17] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_031717
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:17:18] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:17:18] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 03:17:18] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:17:18] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:17:42] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.38%
[24/06/19 03:18:04] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.07%
[24/06/19 03:18:26] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.23%
[24/06/19 03:18:48] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.76%
[24/06/19 03:19:10] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.49%
[24/06/19 03:19:32] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.82%
[24/06/19 03:19:54] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.73%
[24/06/19 03:20:16] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.16%
[24/06/19 03:20:38] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.86%
[24/06/19 03:21:00] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.02%
[24/06/19 03:21:22] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.44%
[24/06/19 03:21:44] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.72%
[24/06/19 03:22:06] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.27%
[24/06/19 03:22:28] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.15%
[24/06/19 03:22:50] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.77%
[24/06/19 03:22:50] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.32%
[24/06/19 03:22:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_032253
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:22:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_032256
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:22:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_032258
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:22:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:22:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 03:22:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:22:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:23:16] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.13%
[24/06/19 03:23:32] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.06%
[24/06/19 03:23:47] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.73%
[24/06/19 03:24:02] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.48%
[24/06/19 03:24:17] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.51%
[24/06/19 03:24:33] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.52%
[24/06/19 03:24:48] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.72%
[24/06/19 03:25:03] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.12%
[24/06/19 03:25:18] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.99%
[24/06/19 03:25:34] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.03%
[24/06/19 03:25:49] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.13%
[24/06/19 03:26:04] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.20%
[24/06/19 03:26:19] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.97%
[24/06/19 03:26:35] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.30%
[24/06/19 03:26:50] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.61%
[24/06/19 03:26:50] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.50%
[24/06/19 03:26:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_032653
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:26:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:26:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 03:26:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:26:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:27:11] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.15%
[24/06/19 03:27:26] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.06%
[24/06/19 03:27:41] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.75%
[24/06/19 03:27:57] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.51%
[24/06/19 03:28:12] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.45%
[24/06/19 03:28:27] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.54%
[24/06/19 03:28:42] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.72%
[24/06/19 03:28:58] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.13%
[24/06/19 03:29:13] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.91%
[24/06/19 03:29:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.07%
[24/06/19 03:29:43] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.13%
[24/06/19 03:29:59] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.20%
[24/06/19 03:30:14] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.01%
[24/06/19 03:30:29] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.34%
[24/06/19 03:30:44] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.52%
[24/06/19 03:30:44] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.50%
[24/06/19 03:30:47] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_033047
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:30:48] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:30:48] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 03:30:48] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:30:48] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:31:09] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.67%
[24/06/19 03:31:28] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.76%
[24/06/19 03:31:46] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.94%
[24/06/19 03:32:05] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.49%
[24/06/19 03:32:24] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.70%
[24/06/19 03:32:43] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.09%
[24/06/19 03:33:01] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.75%
[24/06/19 03:33:20] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.43%
[24/06/19 03:33:39] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.75%
[24/06/19 03:33:58] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.41%
[24/06/19 03:34:16] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.06%
[24/06/19 03:34:35] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.15%
[24/06/19 03:34:54] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.87%
[24/06/19 03:35:13] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.92%
[24/06/19 03:35:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.65%
[24/06/19 03:35:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.18%
[24/06/19 03:35:34] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_033534
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:35:35] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:35:35] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 03:35:35] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:35:35] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:35:56] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.66%
[24/06/19 03:36:15] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.77%
[24/06/19 03:36:33] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.98%
[24/06/19 03:36:52] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.43%
[24/06/19 03:37:11] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.68%
[24/06/19 03:37:30] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.08%
[24/06/19 03:37:48] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.76%
[24/06/19 03:38:07] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.38%
[24/06/19 03:38:26] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.71%
[24/06/19 03:38:45] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.46%
[24/06/19 03:39:03] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.05%
[24/06/19 03:39:22] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.16%
[24/06/19 03:39:41] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.00%
[24/06/19 03:40:00] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.92%
[24/06/19 03:40:19] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.68%
[24/06/19 03:40:19] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.18%
[24/06/19 03:40:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_034021
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:40:22] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:40:22] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 03:40:22] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:40:22] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:40:46] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.22%
[24/06/19 03:41:08] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.75%
[24/06/19 03:41:30] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.78%
[24/06/19 03:41:52] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.95%
[24/06/19 03:42:14] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.40%
[24/06/19 03:42:36] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.88%
[24/06/19 03:42:58] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.75%
[24/06/19 03:43:20] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.18%
[24/06/19 03:43:42] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.83%
[24/06/19 03:44:04] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.15%
[24/06/19 03:44:26] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.58%
[24/06/19 03:44:48] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.70%
[24/06/19 03:45:10] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.30%
[24/06/19 03:45:32] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.15%
[24/06/19 03:45:54] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.74%
[24/06/19 03:45:54] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.29%
[24/06/19 03:45:57] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_034557
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:45:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:45:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 03:45:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:45:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:46:22] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.20%
[24/06/19 03:46:44] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.75%
[24/06/19 03:47:06] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.81%
[24/06/19 03:47:28] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.93%
[24/06/19 03:47:50] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.42%
[24/06/19 03:48:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.89%
[24/06/19 03:48:34] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.73%
[24/06/19 03:48:56] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.16%
[24/06/19 03:49:18] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.83%
[24/06/19 03:49:40] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.13%
[24/06/19 03:50:02] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.60%
[24/06/19 03:50:24] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.70%
[24/06/19 03:50:46] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.25%
[24/06/19 03:51:08] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.15%
[24/06/19 03:51:30] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.68%
[24/06/19 03:51:30] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.28%
[24/06/19 03:51:33] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_035133
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:51:35] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_035135
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:51:38] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_035138
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:51:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:51:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 03:51:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:51:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:51:56] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.06%
[24/06/19 03:52:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.82%
[24/06/19 03:52:27] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.48%
[24/06/19 03:52:42] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.64%
[24/06/19 03:52:57] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.39%
[24/06/19 03:53:13] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.52%
[24/06/19 03:53:28] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.77%
[24/06/19 03:53:43] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.13%
[24/06/19 03:53:58] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.87%
[24/06/19 03:54:14] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.98%
[24/06/19 03:54:29] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.24%
[24/06/19 03:54:44] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.23%
[24/06/19 03:54:59] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.99%
[24/06/19 03:55:15] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.33%
[24/06/19 03:55:30] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.59%
[24/06/19 03:55:30] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.47%
[24/06/19 03:55:33] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_035533
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:55:33] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:55:33] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 03:55:33] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:55:33] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:55:51] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.09%
[24/06/19 03:56:06] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.74%
[24/06/19 03:56:21] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.52%
[24/06/19 03:56:36] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.62%
[24/06/19 03:56:52] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.31%
[24/06/19 03:57:07] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.48%
[24/06/19 03:57:22] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.71%
[24/06/19 03:57:37] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.15%
[24/06/19 03:57:53] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.84%
[24/06/19 03:58:08] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.05%
[24/06/19 03:58:23] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.24%
[24/06/19 03:58:38] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.26%
[24/06/19 03:58:54] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.96%
[24/06/19 03:59:09] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.35%
[24/06/19 03:59:24] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.58%
[24/06/19 03:59:24] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.46%
[24/06/19 03:59:27] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_035927
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 03:59:27] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 03:59:27] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 03:59:27] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 03:59:27] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 03:59:49] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.55%
[24/06/19 04:00:07] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.52%
[24/06/19 04:00:26] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.63%
[24/06/19 04:00:45] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.61%
[24/06/19 04:01:04] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.68%
[24/06/19 04:01:22] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.26%
[24/06/19 04:01:41] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.72%
[24/06/19 04:02:00] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.48%
[24/06/19 04:02:19] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.71%
[24/06/19 04:02:37] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.55%
[24/06/19 04:02:56] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.14%
[24/06/19 04:03:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.15%
[24/06/19 04:03:33] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.98%
[24/06/19 04:03:52] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.94%
[24/06/19 04:04:11] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.57%
[24/06/19 04:04:11] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.17%
[24/06/19 04:04:14] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_040414
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:04:14] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:04:14] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 04:04:14] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:04:14] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:04:35] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.54%
[24/06/19 04:04:54] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.51%
[24/06/19 04:05:13] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.66%
[24/06/19 04:05:32] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.61%
[24/06/19 04:05:50] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.69%
[24/06/19 04:06:09] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.28%
[24/06/19 04:06:28] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.70%
[24/06/19 04:06:47] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.49%
[24/06/19 04:07:06] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.74%
[24/06/19 04:07:24] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.55%
[24/06/19 04:07:43] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.14%
[24/06/19 04:08:02] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.16%
[24/06/19 04:08:21] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.97%
[24/06/19 04:08:39] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.92%
[24/06/19 04:08:58] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.55%
[24/06/19 04:08:58] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.17%
[24/06/19 04:09:01] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_040901
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:09:01] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:09:01] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 04:09:01] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:09:01] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:09:26] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.08%
[24/06/19 04:09:48] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.55%
[24/06/19 04:10:10] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.58%
[24/06/19 04:10:32] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.95%
[24/06/19 04:10:54] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.44%
[24/06/19 04:11:16] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.94%
[24/06/19 04:11:38] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.77%
[24/06/19 04:12:00] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.21%
[24/06/19 04:12:22] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.79%
[24/06/19 04:12:44] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.19%
[24/06/19 04:13:06] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.66%
[24/06/19 04:13:28] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.84%
[24/06/19 04:13:50] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.30%
[24/06/19 04:14:12] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.23%
[24/06/19 04:14:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.56%
[24/06/19 04:14:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.27%
[24/06/19 04:14:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_041436
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:14:37] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:14:37] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 04:14:37] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:14:37] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:15:01] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.12%
[24/06/19 04:15:23] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.58%
[24/06/19 04:15:45] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.52%
[24/06/19 04:16:07] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.98%
[24/06/19 04:16:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.45%
[24/06/19 04:16:51] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.92%
[24/06/19 04:17:13] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.73%
[24/06/19 04:17:35] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.17%
[24/06/19 04:17:57] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.78%
[24/06/19 04:18:19] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.22%
[24/06/19 04:18:41] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.63%
[24/06/19 04:19:03] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.86%
[24/06/19 04:19:25] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.25%
[24/06/19 04:19:47] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.24%
[24/06/19 04:20:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.55%
[24/06/19 04:20:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.27%
[24/06/19 04:20:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_042012
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:20:14] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_042014
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:20:17] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_042017
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:20:18] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:20:18] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 04:20:18] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:20:18] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:20:35] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.92%
[24/06/19 04:20:51] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.48%
[24/06/19 04:21:06] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.32%
[24/06/19 04:21:21] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.62%
[24/06/19 04:21:36] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.26%
[24/06/19 04:21:52] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.60%
[24/06/19 04:22:07] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.77%
[24/06/19 04:22:22] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.19%
[24/06/19 04:22:37] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.93%
[24/06/19 04:22:53] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.08%
[24/06/19 04:23:08] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.29%
[24/06/19 04:23:23] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.22%
[24/06/19 04:23:38] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.02%
[24/06/19 04:23:54] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.34%
[24/06/19 04:24:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.52%
[24/06/19 04:24:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.44%
[24/06/19 04:24:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_042412
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:24:12] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:24:12] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 04:24:12] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:24:12] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:24:30] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.93%
[24/06/19 04:24:45] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.50%
[24/06/19 04:25:00] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.27%
[24/06/19 04:25:16] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.61%
[24/06/19 04:25:31] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.23%
[24/06/19 04:25:46] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.57%
[24/06/19 04:26:01] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.85%
[24/06/19 04:26:17] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.18%
[24/06/19 04:26:32] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.88%
[24/06/19 04:26:47] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.04%
[24/06/19 04:27:02] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.25%
[24/06/19 04:27:18] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.20%
[24/06/19 04:27:33] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.03%
[24/06/19 04:27:48] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.41%
[24/06/19 04:28:03] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.47%
[24/06/19 04:28:03] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.43%
[24/06/19 04:28:06] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_042806
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:28:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:28:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 04:28:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:28:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:28:28] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.46%
[24/06/19 04:28:47] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.18%
[24/06/19 04:29:05] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.50%
[24/06/19 04:29:24] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.71%
[24/06/19 04:29:43] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.51%
[24/06/19 04:30:02] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.25%
[24/06/19 04:30:20] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.74%
[24/06/19 04:30:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.42%
[24/06/19 04:30:58] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.79%
[24/06/19 04:31:16] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.58%
[24/06/19 04:31:35] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.20%
[24/06/19 04:31:54] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.25%
[24/06/19 04:32:13] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.05%
[24/06/19 04:32:31] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.95%
[24/06/19 04:32:50] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.52%
[24/06/19 04:32:50] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.14%
[24/06/19 04:32:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_043253
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:32:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:32:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 04:32:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:32:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:33:15] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.46%
[24/06/19 04:33:33] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.19%
[24/06/19 04:33:52] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.51%
[24/06/19 04:34:11] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.68%
[24/06/19 04:34:30] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.52%
[24/06/19 04:34:48] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.27%
[24/06/19 04:35:07] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.73%
[24/06/19 04:35:26] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.45%
[24/06/19 04:35:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.78%
[24/06/19 04:36:03] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.56%
[24/06/19 04:36:22] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.15%
[24/06/19 04:36:41] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.23%
[24/06/19 04:37:00] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.01%
[24/06/19 04:37:18] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.91%
[24/06/19 04:37:37] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.52%
[24/06/19 04:37:37] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.13%
[24/06/19 04:37:40] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_043740
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:37:40] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:37:40] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 04:37:40] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:37:40] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:38:05] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.01%
[24/06/19 04:38:27] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.35%
[24/06/19 04:38:49] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.29%
[24/06/19 04:39:11] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.04%
[24/06/19 04:39:33] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.40%
[24/06/19 04:39:55] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.93%
[24/06/19 04:40:17] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.80%
[24/06/19 04:40:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.04%
[24/06/19 04:41:01] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.82%
[24/06/19 04:41:23] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.17%
[24/06/19 04:41:45] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.76%
[24/06/19 04:42:07] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.53%
[24/06/19 04:42:29] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.28%
[24/06/19 04:42:51] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.20%
[24/06/19 04:43:13] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.38%
[24/06/19 04:43:13] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.20%
[24/06/19 04:43:16] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_044316
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:43:16] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:43:16] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 04:43:16] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:43:16] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:43:40] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.02%
[24/06/19 04:44:02] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.34%
[24/06/19 04:44:24] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.33%
[24/06/19 04:44:46] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.03%
[24/06/19 04:45:08] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.33%
[24/06/19 04:45:30] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.98%
[24/06/19 04:45:52] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.81%
[24/06/19 04:46:14] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.05%
[24/06/19 04:46:36] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.83%
[24/06/19 04:46:58] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.13%
[24/06/19 04:47:20] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.72%
[24/06/19 04:47:42] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.56%
[24/06/19 04:48:04] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.29%
[24/06/19 04:48:26] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.13%
[24/06/19 04:48:48] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.45%
[24/06/19 04:48:48] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.20%
[24/06/19 04:48:51] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_044851
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:48:54] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_044854
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:48:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_044856
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:48:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:48:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 04:48:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:48:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:49:14] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.76%
[24/06/19 04:49:30] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.39%
[24/06/19 04:49:45] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.07%
[24/06/19 04:50:00] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.65%
[24/06/19 04:50:15] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.21%
[24/06/19 04:50:31] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.51%
[24/06/19 04:50:46] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.86%
[24/06/19 04:51:01] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.11%
[24/06/19 04:51:16] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.98%
[24/06/19 04:51:32] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.00%
[24/06/19 04:51:47] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.40%
[24/06/19 04:52:02] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.20%
[24/06/19 04:52:17] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.03%
[24/06/19 04:52:33] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.42%
[24/06/19 04:52:48] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.55%
[24/06/19 04:52:48] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.41%
[24/06/19 04:52:51] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_045251
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:52:51] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:52:51] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 04:52:51] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:52:51] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:53:09] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.73%
[24/06/19 04:53:24] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.38%
[24/06/19 04:53:39] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 56.04%
[24/06/19 04:53:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.64%
[24/06/19 04:54:10] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.29%
[24/06/19 04:54:25] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.55%
[24/06/19 04:54:40] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.84%
[24/06/19 04:54:56] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.14%
[24/06/19 04:55:11] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.98%
[24/06/19 04:55:26] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.01%
[24/06/19 04:55:41] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.36%
[24/06/19 04:55:57] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.19%
[24/06/19 04:56:12] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.09%
[24/06/19 04:56:27] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.44%
[24/06/19 04:56:42] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.60%
[24/06/19 04:56:42] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.42%
[24/06/19 04:56:45] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_045645
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 04:56:46] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 04:56:46] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 04:56:46] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 04:56:46] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 04:57:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.29%
[24/06/19 04:57:26] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.85%
[24/06/19 04:57:44] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.27%
[24/06/19 04:58:03] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.73%
[24/06/19 04:58:22] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.58%
[24/06/19 04:58:41] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.42%
[24/06/19 04:58:59] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.78%
[24/06/19 04:59:18] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.44%
[24/06/19 04:59:37] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.69%
[24/06/19 04:59:56] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.57%
[24/06/19 05:00:14] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.14%
[24/06/19 05:00:33] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.24%
[24/06/19 05:00:52] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.95%
[24/06/19 05:01:11] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.94%
[24/06/19 05:01:29] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.44%
[24/06/19 05:01:29] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.09%
[24/06/19 05:01:32] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_050132
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:01:32] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:01:32] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 05:01:32] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:01:32] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:01:54] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.29%
[24/06/19 05:02:13] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.87%
[24/06/19 05:02:31] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.30%
[24/06/19 05:02:50] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.72%
[24/06/19 05:03:09] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.58%
[24/06/19 05:03:28] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.41%
[24/06/19 05:03:46] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.81%
[24/06/19 05:04:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.40%
[24/06/19 05:04:24] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.71%
[24/06/19 05:04:43] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.61%
[24/06/19 05:05:01] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.11%
[24/06/19 05:05:20] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.33%
[24/06/19 05:05:39] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.96%
[24/06/19 05:05:58] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.96%
[24/06/19 05:06:16] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.43%
[24/06/19 05:06:16] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.10%
[24/06/19 05:06:19] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_050619
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:06:20] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:06:20] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 05:06:20] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:06:20] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:06:44] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.87%
[24/06/19 05:07:06] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.06%
[24/06/19 05:07:28] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.14%
[24/06/19 05:07:50] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.10%
[24/06/19 05:08:12] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.26%
[24/06/19 05:08:34] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.11%
[24/06/19 05:08:56] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.88%
[24/06/19 05:09:18] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.02%
[24/06/19 05:09:40] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.03%
[24/06/19 05:10:02] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.19%
[24/06/19 05:10:24] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.88%
[24/06/19 05:10:46] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.51%
[24/06/19 05:11:08] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.43%
[24/06/19 05:11:30] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.24%
[24/06/19 05:11:52] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.43%
[24/06/19 05:11:52] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.21%
[24/06/19 05:11:55] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_051155
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:11:55] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:11:55] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 05:11:55] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:11:55] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:12:20] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.87%
[24/06/19 05:12:42] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.09%
[24/06/19 05:13:04] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.13%
[24/06/19 05:13:26] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.11%
[24/06/19 05:13:48] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.26%
[24/06/19 05:14:10] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.09%
[24/06/19 05:14:32] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.88%
[24/06/19 05:14:54] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.99%
[24/06/19 05:15:15] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.97%
[24/06/19 05:15:37] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.22%
[24/06/19 05:15:59] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.87%
[24/06/19 05:16:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.51%
[24/06/19 05:16:43] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.43%
[24/06/19 05:17:05] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.13%
[24/06/19 05:17:27] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.37%
[24/06/19 05:17:27] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.19%
[24/06/19 05:17:30] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_051730
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:17:33] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_051733
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:17:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_051736
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:17:36] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:17:36] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 05:17:36] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:17:36] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:17:53] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.66%
[24/06/19 05:18:09] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.08%
[24/06/19 05:18:24] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.94%
[24/06/19 05:18:39] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.67%
[24/06/19 05:18:55] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.12%
[24/06/19 05:19:10] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.53%
[24/06/19 05:19:25] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.77%
[24/06/19 05:19:40] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.05%
[24/06/19 05:19:56] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.94%
[24/06/19 05:20:11] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.95%
[24/06/19 05:20:26] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.44%
[24/06/19 05:20:41] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.26%
[24/06/19 05:20:57] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 05:21:12] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.47%
[24/06/19 05:21:27] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.68%
[24/06/19 05:21:27] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.38%
[24/06/19 05:21:30] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_052130
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:21:30] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:21:30] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 05:21:30] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:21:30] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:21:48] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.69%
[24/06/19 05:22:03] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 51.08%
[24/06/19 05:22:19] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.90%
[24/06/19 05:22:34] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.65%
[24/06/19 05:22:49] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.11%
[24/06/19 05:23:04] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.55%
[24/06/19 05:23:19] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.80%
[24/06/19 05:23:35] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.17%
[24/06/19 05:23:50] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.94%
[24/06/19 05:24:05] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.97%
[24/06/19 05:24:20] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.46%
[24/06/19 05:24:36] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.26%
[24/06/19 05:24:51] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.08%
[24/06/19 05:25:06] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.46%
[24/06/19 05:25:21] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.63%
[24/06/19 05:25:21] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.38%
[24/06/19 05:25:24] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_052524
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:25:25] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:25:25] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 05:25:25] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:25:25] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:25:46] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.16%
[24/06/19 05:26:05] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.65%
[24/06/19 05:26:24] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.17%
[24/06/19 05:26:42] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.80%
[24/06/19 05:27:01] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.55%
[24/06/19 05:27:20] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.51%
[24/06/19 05:27:39] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.87%
[24/06/19 05:27:57] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.50%
[24/06/19 05:28:16] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.75%
[24/06/19 05:28:35] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.60%
[24/06/19 05:28:54] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.15%
[24/06/19 05:29:12] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.43%
[24/06/19 05:29:31] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.04%
[24/06/19 05:29:50] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.96%
[24/06/19 05:30:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.52%
[24/06/19 05:30:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.11%
[24/06/19 05:30:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_053012
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:30:12] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:30:12] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 05:30:12] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:30:12] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:30:33] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.15%
[24/06/19 05:30:52] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.64%
[24/06/19 05:31:11] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.18%
[24/06/19 05:31:29] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.85%
[24/06/19 05:31:48] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.54%
[24/06/19 05:32:07] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.52%
[24/06/19 05:32:26] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.83%
[24/06/19 05:32:44] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.53%
[24/06/19 05:33:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.73%
[24/06/19 05:33:22] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.61%
[24/06/19 05:33:41] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.20%
[24/06/19 05:33:59] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.42%
[24/06/19 05:34:18] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.00%
[24/06/19 05:34:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.97%
[24/06/19 05:34:56] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.51%
[24/06/19 05:34:56] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.11%
[24/06/19 05:34:59] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_053459
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:34:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:34:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 05:34:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:34:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:35:24] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.71%
[24/06/19 05:35:46] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.95%
[24/06/19 05:36:07] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.98%
[24/06/19 05:36:29] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.14%
[24/06/19 05:36:51] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.10%
[24/06/19 05:37:13] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.14%
[24/06/19 05:37:35] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.95%
[24/06/19 05:37:57] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.98%
[24/06/19 05:38:19] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.97%
[24/06/19 05:38:41] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.25%
[24/06/19 05:39:03] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.90%
[24/06/19 05:39:25] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.62%
[24/06/19 05:39:47] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.53%
[24/06/19 05:40:09] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.09%
[24/06/19 05:40:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.44%
[24/06/19 05:40:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.18%
[24/06/19 05:40:34] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_054034
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:40:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:40:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 05:40:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:40:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:40:59] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.71%
[24/06/19 05:41:21] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.93%
[24/06/19 05:41:43] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 54.01%
[24/06/19 05:42:05] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.15%
[24/06/19 05:42:27] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.15%
[24/06/19 05:42:49] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.15%
[24/06/19 05:43:11] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.95%
[24/06/19 05:43:33] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.02%
[24/06/19 05:43:55] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.01%
[24/06/19 05:44:17] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.24%
[24/06/19 05:44:39] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.88%
[24/06/19 05:45:00] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.64%
[24/06/19 05:45:22] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.50%
[24/06/19 05:45:44] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.12%
[24/06/19 05:46:06] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.50%
[24/06/19 05:46:06] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.20%
[24/06/19 05:46:09] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_054609
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:46:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_054612
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:46:15] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_054615
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:46:15] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:46:15] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 05:46:15] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:46:15] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:46:33] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.63%
[24/06/19 05:46:48] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.77%
[24/06/19 05:47:03] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.71%
[24/06/19 05:47:19] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.62%
[24/06/19 05:47:34] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.15%
[24/06/19 05:47:49] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.55%
[24/06/19 05:48:04] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.82%
[24/06/19 05:48:20] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.10%
[24/06/19 05:48:35] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.99%
[24/06/19 05:48:50] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.98%
[24/06/19 05:49:06] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.39%
[24/06/19 05:49:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.28%
[24/06/19 05:49:36] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 05:49:51] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.38%
[24/06/19 05:50:07] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.50%
[24/06/19 05:50:07] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.33%
[24/06/19 05:50:10] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_055010
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:50:10] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:50:10] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 05:50:10] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:50:10] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:50:28] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.66%
[24/06/19 05:50:43] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.75%
[24/06/19 05:50:58] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.73%
[24/06/19 05:51:13] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.58%
[24/06/19 05:51:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.14%
[24/06/19 05:51:44] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.57%
[24/06/19 05:51:59] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.84%
[24/06/19 05:52:14] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.15%
[24/06/19 05:52:30] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.95%
[24/06/19 05:52:45] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.98%
[24/06/19 05:53:00] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.43%
[24/06/19 05:53:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.28%
[24/06/19 05:53:31] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 05:53:46] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.35%
[24/06/19 05:54:01] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.55%
[24/06/19 05:54:01] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.34%
[24/06/19 05:54:04] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_055404
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:54:04] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:54:04] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 05:54:04] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:54:04] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:54:26] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.96%
[24/06/19 05:54:45] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.49%
[24/06/19 05:55:03] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.01%
[24/06/19 05:55:22] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.98%
[24/06/19 05:55:41] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.54%
[24/06/19 05:55:59] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.64%
[24/06/19 05:56:18] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.00%
[24/06/19 05:56:37] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.50%
[24/06/19 05:56:56] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.83%
[24/06/19 05:57:14] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.73%
[24/06/19 05:57:33] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.27%
[24/06/19 05:57:52] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.49%
[24/06/19 05:58:10] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.07%
[24/06/19 05:58:29] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.95%
[24/06/19 05:58:48] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.41%
[24/06/19 05:58:48] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.12%
[24/06/19 05:58:51] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_055851
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 05:58:51] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 05:58:51] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 05:58:51] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 05:58:51] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 05:59:12] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.97%
[24/06/19 05:59:31] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.49%
[24/06/19 05:59:50] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.00%
[24/06/19 06:00:09] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.00%
[24/06/19 06:00:27] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.51%
[24/06/19 06:00:46] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.66%
[24/06/19 06:01:05] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.02%
[24/06/19 06:01:24] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.47%
[24/06/19 06:01:42] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.79%
[24/06/19 06:02:01] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.75%
[24/06/19 06:02:20] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.27%
[24/06/19 06:02:39] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.44%
[24/06/19 06:02:57] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.08%
[24/06/19 06:03:16] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.99%
[24/06/19 06:03:35] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.42%
[24/06/19 06:03:35] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.12%
[24/06/19 06:03:38] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_060338
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:03:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:03:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 06:03:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:03:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:04:03] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.60%
[24/06/19 06:04:25] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.81%
[24/06/19 06:04:47] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.70%
[24/06/19 06:05:09] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.25%
[24/06/19 06:05:30] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.22%
[24/06/19 06:05:52] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.26%
[24/06/19 06:06:14] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.95%
[24/06/19 06:06:36] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.96%
[24/06/19 06:06:58] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.97%
[24/06/19 06:07:20] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.31%
[24/06/19 06:07:42] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.05%
[24/06/19 06:08:04] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.69%
[24/06/19 06:08:26] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.71%
[24/06/19 06:08:48] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.18%
[24/06/19 06:09:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.42%
[24/06/19 06:09:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.21%
[24/06/19 06:09:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_060912
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:09:13] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:09:13] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 06:09:13] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:09:13] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:09:38] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.62%
[24/06/19 06:10:00] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.78%
[24/06/19 06:10:21] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.69%
[24/06/19 06:10:43] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.24%
[24/06/19 06:11:05] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.28%
[24/06/19 06:11:27] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.28%
[24/06/19 06:11:49] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.93%
[24/06/19 06:12:11] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.98%
[24/06/19 06:12:33] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.98%
[24/06/19 06:12:55] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.34%
[24/06/19 06:13:17] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.04%
[24/06/19 06:13:39] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.60%
[24/06/19 06:14:01] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.64%
[24/06/19 06:14:23] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.16%
[24/06/19 06:14:45] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.33%
[24/06/19 06:14:45] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.19%
[24/06/19 06:14:48] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_061448
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:14:50] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_061450
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:14:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_061453
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:14:54] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:14:54] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 06:14:54] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:14:54] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:15:11] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.53%
[24/06/19 06:15:26] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.48%
[24/06/19 06:15:42] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.61%
[24/06/19 06:15:57] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.60%
[24/06/19 06:16:12] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.07%
[24/06/19 06:16:27] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.63%
[24/06/19 06:16:43] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.82%
[24/06/19 06:16:58] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.18%
[24/06/19 06:17:13] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.07%
[24/06/19 06:17:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.96%
[24/06/19 06:17:44] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.50%
[24/06/19 06:17:59] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.36%
[24/06/19 06:18:14] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.13%
[24/06/19 06:18:29] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.38%
[24/06/19 06:18:45] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.44%
[24/06/19 06:18:45] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.32%
[24/06/19 06:18:48] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_061848
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:18:48] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:18:48] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 06:18:48] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:18:48] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:19:06] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.54%
[24/06/19 06:19:21] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.49%
[24/06/19 06:19:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.57%
[24/06/19 06:19:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.59%
[24/06/19 06:20:06] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.01%
[24/06/19 06:20:22] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.70%
[24/06/19 06:20:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.86%
[24/06/19 06:20:52] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.18%
[24/06/19 06:21:08] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.96%
[24/06/19 06:21:23] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.06%
[24/06/19 06:21:38] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.45%
[24/06/19 06:21:53] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.36%
[24/06/19 06:22:09] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.16%
[24/06/19 06:22:24] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.39%
[24/06/19 06:22:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.39%
[24/06/19 06:22:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.31%
[24/06/19 06:22:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_062242
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:22:42] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:22:42] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 06:22:42] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:22:42] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:23:04] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.74%
[24/06/19 06:23:22] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.14%
[24/06/19 06:23:41] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.74%
[24/06/19 06:24:00] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.01%
[24/06/19 06:24:19] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.43%
[24/06/19 06:24:37] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.60%
[24/06/19 06:24:56] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.10%
[24/06/19 06:25:15] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.66%
[24/06/19 06:25:33] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.82%
[24/06/19 06:25:52] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.76%
[24/06/19 06:26:11] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.34%
[24/06/19 06:26:30] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.54%
[24/06/19 06:26:48] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.14%
[24/06/19 06:27:07] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.13%
[24/06/19 06:27:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.46%
[24/06/19 06:27:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.11%
[24/06/19 06:27:29] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_062729
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:27:29] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:27:29] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 06:27:29] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:27:29] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:27:50] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.77%
[24/06/19 06:28:09] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.16%
[24/06/19 06:28:28] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.78%
[24/06/19 06:28:46] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.00%
[24/06/19 06:29:05] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.41%
[24/06/19 06:29:24] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.63%
[24/06/19 06:29:43] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.15%
[24/06/19 06:30:01] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.64%
[24/06/19 06:30:20] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.87%
[24/06/19 06:30:39] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.70%
[24/06/19 06:30:58] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.34%
[24/06/19 06:31:16] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.49%
[24/06/19 06:31:35] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.14%
[24/06/19 06:31:54] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.05%
[24/06/19 06:32:12] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.44%
[24/06/19 06:32:13] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.10%
[24/06/19 06:32:15] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_063215
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:32:16] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:32:16] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 06:32:16] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:32:16] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:32:40] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.51%
[24/06/19 06:33:02] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.54%
[24/06/19 06:33:24] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.60%
[24/06/19 06:33:46] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.30%
[24/06/19 06:34:08] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.28%
[24/06/19 06:34:30] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.29%
[24/06/19 06:34:52] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.94%
[24/06/19 06:35:14] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.04%
[24/06/19 06:35:36] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.04%
[24/06/19 06:35:58] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.32%
[24/06/19 06:36:20] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.09%
[24/06/19 06:36:41] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.70%
[24/06/19 06:37:03] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.68%
[24/06/19 06:37:25] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.26%
[24/06/19 06:37:47] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.38%
[24/06/19 06:37:47] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.20%
[24/06/19 06:37:50] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_063750
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:37:50] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:37:50] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 06:37:51] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:37:51] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:38:15] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.50%
[24/06/19 06:38:37] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.60%
[24/06/19 06:38:59] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.60%
[24/06/19 06:39:21] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.29%
[24/06/19 06:39:43] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.20%
[24/06/19 06:40:05] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.28%
[24/06/19 06:40:27] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.95%
[24/06/19 06:40:49] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.04%
[24/06/19 06:41:11] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.07%
[24/06/19 06:41:33] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.30%
[24/06/19 06:41:55] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.13%
[24/06/19 06:42:16] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.78%
[24/06/19 06:42:38] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.69%
[24/06/19 06:43:00] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.24%
[24/06/19 06:43:22] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.37%
[24/06/19 06:43:22] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.20%
[24/06/19 06:43:25] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_064325
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:43:28] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_064328
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:43:31] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_064331
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:43:31] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:43:31] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 06:43:31] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:43:31] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:43:49] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.45%
[24/06/19 06:44:04] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.29%
[24/06/19 06:44:19] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.45%
[24/06/19 06:44:35] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.73%
[24/06/19 06:44:50] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.00%
[24/06/19 06:45:05] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.77%
[24/06/19 06:45:20] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.82%
[24/06/19 06:45:36] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.32%
[24/06/19 06:45:51] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.99%
[24/06/19 06:46:06] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.08%
[24/06/19 06:46:21] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.55%
[24/06/19 06:46:37] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.44%
[24/06/19 06:46:52] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.02%
[24/06/19 06:47:07] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.54%
[24/06/19 06:47:22] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.44%
[24/06/19 06:47:22] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.33%
[24/06/19 06:47:25] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_064725
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:47:25] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:47:25] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 06:47:25] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:47:25] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:47:43] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.44%
[24/06/19 06:47:58] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.25%
[24/06/19 06:48:14] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.44%
[24/06/19 06:48:29] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.72%
[24/06/19 06:48:44] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.98%
[24/06/19 06:48:59] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.75%
[24/06/19 06:49:15] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.84%
[24/06/19 06:49:30] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.26%
[24/06/19 06:49:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.95%
[24/06/19 06:50:00] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.08%
[24/06/19 06:50:16] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.53%
[24/06/19 06:50:31] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.41%
[24/06/19 06:50:46] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.12%
[24/06/19 06:51:02] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.53%
[24/06/19 06:51:17] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.57%
[24/06/19 06:51:17] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.32%
[24/06/19 06:51:20] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_065120
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:51:20] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:51:20] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 06:51:20] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:51:20] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:51:41] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.64%
[24/06/19 06:52:00] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.86%
[24/06/19 06:52:19] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.65%
[24/06/19 06:52:37] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.99%
[24/06/19 06:52:56] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.37%
[24/06/19 06:53:15] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.72%
[24/06/19 06:53:34] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.15%
[24/06/19 06:53:52] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.66%
[24/06/19 06:54:11] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.87%
[24/06/19 06:54:30] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.73%
[24/06/19 06:54:49] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.51%
[24/06/19 06:55:07] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.55%
[24/06/19 06:55:26] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.11%
[24/06/19 06:55:45] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.02%
[24/06/19 06:56:03] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.32%
[24/06/19 06:56:04] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.08%
[24/06/19 06:56:07] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_065607
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 06:56:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 06:56:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 06:56:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 06:56:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 06:56:28] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.63%
[24/06/19 06:56:47] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.84%
[24/06/19 06:57:05] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.62%
[24/06/19 06:57:24] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.99%
[24/06/19 06:57:43] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.35%
[24/06/19 06:58:02] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.70%
[24/06/19 06:58:20] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.19%
[24/06/19 06:58:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.66%
[24/06/19 06:58:58] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.86%
[24/06/19 06:59:16] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.76%
[24/06/19 06:59:35] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.54%
[24/06/19 06:59:54] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.47%
[24/06/19 07:00:13] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.05%
[24/06/19 07:00:31] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.06%
[24/06/19 07:00:50] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.33%
[24/06/19 07:00:50] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.07%
[24/06/19 07:00:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_070053
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:00:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:00:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 07:00:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:00:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:01:18] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.38%
[24/06/19 07:01:40] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.33%
[24/06/19 07:02:02] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.46%
[24/06/19 07:02:23] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.38%
[24/06/19 07:02:45] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.16%
[24/06/19 07:03:07] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.43%
[24/06/19 07:03:29] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.04%
[24/06/19 07:03:51] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.12%
[24/06/19 07:04:13] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.09%
[24/06/19 07:04:35] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.59%
[24/06/19 07:04:57] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.19%
[24/06/19 07:05:19] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.79%
[24/06/19 07:05:40] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.71%
[24/06/19 07:06:02] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.35%
[24/06/19 07:06:24] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.39%
[24/06/19 07:06:24] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.23%
[24/06/19 07:06:27] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_070627
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:06:27] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:06:27] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 07:06:27] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:06:27] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:06:52] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.36%
[24/06/19 07:07:14] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.30%
[24/06/19 07:07:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.46%
[24/06/19 07:07:58] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.44%
[24/06/19 07:08:20] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.16%
[24/06/19 07:08:42] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.39%
[24/06/19 07:09:04] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.06%
[24/06/19 07:09:26] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.09%
[24/06/19 07:09:48] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.08%
[24/06/19 07:10:10] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.48%
[24/06/19 07:10:31] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.22%
[24/06/19 07:10:53] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.82%
[24/06/19 07:11:15] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.75%
[24/06/19 07:11:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.28%
[24/06/19 07:11:59] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.39%
[24/06/19 07:11:59] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.22%
[24/06/19 07:12:02] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_071202
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:12:05] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_071205
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:12:08] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_071208
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:12:08] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:12:08] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 07:12:08] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:12:08] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:12:26] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.35%
[24/06/19 07:12:41] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.09%
[24/06/19 07:12:56] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.33%
[24/06/19 07:13:11] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.72%
[24/06/19 07:13:27] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.98%
[24/06/19 07:13:42] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.81%
[24/06/19 07:13:57] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.94%
[24/06/19 07:14:12] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.23%
[24/06/19 07:14:28] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.05%
[24/06/19 07:14:43] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.02%
[24/06/19 07:14:58] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.66%
[24/06/19 07:15:13] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.45%
[24/06/19 07:15:29] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.13%
[24/06/19 07:15:44] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.54%
[24/06/19 07:15:59] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.46%
[24/06/19 07:15:59] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.32%
[24/06/19 07:16:02] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_071602
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:16:02] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:16:02] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 07:16:02] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:16:02] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:16:20] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.36%
[24/06/19 07:16:35] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.05%
[24/06/19 07:16:51] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.30%
[24/06/19 07:17:06] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.73%
[24/06/19 07:17:21] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.02%
[24/06/19 07:17:36] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.85%
[24/06/19 07:17:52] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.88%
[24/06/19 07:18:07] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.24%
[24/06/19 07:18:22] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.05%
[24/06/19 07:18:37] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.95%
[24/06/19 07:18:53] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.65%
[24/06/19 07:19:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.52%
[24/06/19 07:19:23] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.15%
[24/06/19 07:19:38] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.63%
[24/06/19 07:19:53] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.49%
[24/06/19 07:19:54] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.32%
[24/06/19 07:19:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_071956
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:19:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:19:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 07:19:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:19:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:20:18] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.55%
[24/06/19 07:20:37] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.63%
[24/06/19 07:20:55] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.53%
[24/06/19 07:21:14] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.01%
[24/06/19 07:21:33] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.32%
[24/06/19 07:21:51] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.69%
[24/06/19 07:22:10] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.17%
[24/06/19 07:22:29] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.61%
[24/06/19 07:22:48] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.93%
[24/06/19 07:23:06] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.73%
[24/06/19 07:23:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.63%
[24/06/19 07:23:44] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.57%
[24/06/19 07:24:03] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.08%
[24/06/19 07:24:21] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.03%
[24/06/19 07:24:40] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.14%
[24/06/19 07:24:40] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.04%
[24/06/19 07:24:43] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_072443
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:24:43] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:24:43] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 07:24:43] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:24:43] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:25:04] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.55%
[24/06/19 07:25:23] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.61%
[24/06/19 07:25:42] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.52%
[24/06/19 07:26:01] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.99%
[24/06/19 07:26:19] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.33%
[24/06/19 07:26:38] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.71%
[24/06/19 07:26:57] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.15%
[24/06/19 07:27:15] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.66%
[24/06/19 07:27:34] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.90%
[24/06/19 07:27:53] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.77%
[24/06/19 07:28:12] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.65%
[24/06/19 07:28:30] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.55%
[24/06/19 07:28:49] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.10%
[24/06/19 07:29:08] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.06%
[24/06/19 07:29:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.19%
[24/06/19 07:29:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.05%
[24/06/19 07:29:29] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_072929
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:29:30] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:29:30] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 07:29:30] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:29:30] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:29:54] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.22%
[24/06/19 07:30:16] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.13%
[24/06/19 07:30:38] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.31%
[24/06/19 07:31:00] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.52%
[24/06/19 07:31:22] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.23%
[24/06/19 07:31:44] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.62%
[24/06/19 07:32:06] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.15%
[24/06/19 07:32:28] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.08%
[24/06/19 07:32:50] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.01%
[24/06/19 07:33:12] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.60%
[24/06/19 07:33:34] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.31%
[24/06/19 07:33:56] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.91%
[24/06/19 07:34:17] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.82%
[24/06/19 07:34:39] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.30%
[24/06/19 07:35:01] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.29%
[24/06/19 07:35:01] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.23%
[24/06/19 07:35:04] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_073504
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:35:05] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:35:05] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 07:35:05] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:35:05] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:35:29] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.22%
[24/06/19 07:35:51] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.13%
[24/06/19 07:36:13] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.26%
[24/06/19 07:36:35] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.51%
[24/06/19 07:36:57] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.19%
[24/06/19 07:37:19] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.61%
[24/06/19 07:37:41] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.14%
[24/06/19 07:38:03] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.09%
[24/06/19 07:38:25] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.01%
[24/06/19 07:38:47] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.55%
[24/06/19 07:39:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.27%
[24/06/19 07:39:30] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.93%
[24/06/19 07:39:52] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.77%
[24/06/19 07:40:14] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.36%
[24/06/19 07:40:36] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.36%
[24/06/19 07:40:36] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.23%
[24/06/19 07:40:39] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_074039
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:40:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_074042
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:40:45] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_074045
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:40:45] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:40:45] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 07:40:45] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:40:45] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:41:03] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.24%
[24/06/19 07:41:18] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.85%
[24/06/19 07:41:33] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.23%
[24/06/19 07:41:48] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.80%
[24/06/19 07:42:04] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.03%
[24/06/19 07:42:19] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.86%
[24/06/19 07:42:34] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.87%
[24/06/19 07:42:49] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.22%
[24/06/19 07:43:05] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.03%
[24/06/19 07:43:20] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.03%
[24/06/19 07:43:35] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.70%
[24/06/19 07:43:50] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.59%
[24/06/19 07:44:06] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.11%
[24/06/19 07:44:21] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.59%
[24/06/19 07:44:36] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.57%
[24/06/19 07:44:36] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.31%
[24/06/19 07:44:39] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_074439
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:44:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:44:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 07:44:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:44:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:44:57] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.25%
[24/06/19 07:45:12] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.88%
[24/06/19 07:45:27] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.23%
[24/06/19 07:45:43] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.82%
[24/06/19 07:45:58] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.05%
[24/06/19 07:46:13] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.82%
[24/06/19 07:46:28] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.95%
[24/06/19 07:46:44] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.18%
[24/06/19 07:46:59] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.02%
[24/06/19 07:47:14] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.05%
[24/06/19 07:47:29] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.67%
[24/06/19 07:47:45] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.53%
[24/06/19 07:48:00] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.14%
[24/06/19 07:48:15] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.64%
[24/06/19 07:48:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.62%
[24/06/19 07:48:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.32%
[24/06/19 07:48:33] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_074833
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:48:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:48:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 07:48:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:48:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:48:55] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.41%
[24/06/19 07:49:14] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.44%
[24/06/19 07:49:32] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.42%
[24/06/19 07:49:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.19%
[24/06/19 07:50:10] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.28%
[24/06/19 07:50:29] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.79%
[24/06/19 07:50:48] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.24%
[24/06/19 07:51:06] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.64%
[24/06/19 07:51:25] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.95%
[24/06/19 07:51:44] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.73%
[24/06/19 07:52:03] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.72%
[24/06/19 07:52:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.67%
[24/06/19 07:52:40] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.21%
[24/06/19 07:52:59] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.07%
[24/06/19 07:53:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.23%
[24/06/19 07:53:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.07%
[24/06/19 07:53:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_075321
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:53:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:53:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 07:53:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:53:21] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:53:42] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.40%
[24/06/19 07:54:01] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.44%
[24/06/19 07:54:20] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.41%
[24/06/19 07:54:38] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.18%
[24/06/19 07:54:57] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.31%
[24/06/19 07:55:16] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.76%
[24/06/19 07:55:34] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.19%
[24/06/19 07:55:53] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.66%
[24/06/19 07:56:12] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.92%
[24/06/19 07:56:31] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.69%
[24/06/19 07:56:49] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.66%
[24/06/19 07:57:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.69%
[24/06/19 07:57:27] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.20%
[24/06/19 07:57:45] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.06%
[24/06/19 07:58:04] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.24%
[24/06/19 07:58:04] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.05%
[24/06/19 07:58:07] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_075807
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 07:58:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 07:58:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 07:58:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 07:58:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 07:58:32] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.12%
[24/06/19 07:58:54] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.87%
[24/06/19 07:59:16] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.12%
[24/06/19 07:59:38] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.63%
[24/06/19 08:00:00] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.12%
[24/06/19 08:00:22] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.72%
[24/06/19 08:00:43] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.15%
[24/06/19 08:01:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.05%
[24/06/19 08:01:27] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.09%
[24/06/19 08:01:49] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.67%
[24/06/19 08:02:11] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.36%
[24/06/19 08:02:33] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.99%
[24/06/19 08:02:55] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.92%
[24/06/19 08:03:17] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.33%
[24/06/19 08:03:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.44%
[24/06/19 08:03:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.24%
[24/06/19 08:03:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_080342
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:03:42] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:03:42] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 08:03:42] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:03:42] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:04:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.11%
[24/06/19 08:04:29] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.86%
[24/06/19 08:04:51] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.13%
[24/06/19 08:05:13] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.66%
[24/06/19 08:05:35] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.11%
[24/06/19 08:05:57] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.75%
[24/06/19 08:06:19] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.16%
[24/06/19 08:06:41] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.05%
[24/06/19 08:07:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.09%
[24/06/19 08:07:24] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.71%
[24/06/19 08:07:46] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.35%
[24/06/19 08:08:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.97%
[24/06/19 08:08:30] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.88%
[24/06/19 08:08:52] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.31%
[24/06/19 08:09:14] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.50%
[24/06/19 08:09:14] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.24%
[24/06/19 08:09:17] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_080917
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:09:20] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_080920
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:09:23] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_080923
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:09:23] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:09:23] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 08:09:23] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:09:23] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:09:41] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.09%
[24/06/19 08:09:56] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.74%
[24/06/19 08:10:11] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.13%
[24/06/19 08:10:26] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.99%
[24/06/19 08:10:42] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.20%
[24/06/19 08:10:57] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.84%
[24/06/19 08:11:12] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.92%
[24/06/19 08:11:27] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.27%
[24/06/19 08:11:43] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.15%
[24/06/19 08:11:58] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.11%
[24/06/19 08:12:13] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.78%
[24/06/19 08:12:29] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.62%
[24/06/19 08:12:44] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.19%
[24/06/19 08:12:59] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.69%
[24/06/19 08:13:14] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.72%
[24/06/19 08:13:14] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.36%
[24/06/19 08:13:17] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_081317
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:13:18] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:13:18] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 08:13:18] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:13:18] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:13:35] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.09%
[24/06/19 08:13:51] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.71%
[24/06/19 08:14:06] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.11%
[24/06/19 08:14:21] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.94%
[24/06/19 08:14:36] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.13%
[24/06/19 08:14:52] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.89%
[24/06/19 08:15:07] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.88%
[24/06/19 08:15:22] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.32%
[24/06/19 08:15:37] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.12%
[24/06/19 08:15:53] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.16%
[24/06/19 08:16:08] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.77%
[24/06/19 08:16:23] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.67%
[24/06/19 08:16:39] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.25%
[24/06/19 08:16:54] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.71%
[24/06/19 08:17:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.66%
[24/06/19 08:17:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.36%
[24/06/19 08:17:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_081712
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:17:12] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:17:12] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 08:17:12] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:17:12] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:17:34] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.35%
[24/06/19 08:17:52] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.24%
[24/06/19 08:18:11] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.28%
[24/06/19 08:18:30] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.24%
[24/06/19 08:18:49] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.33%
[24/06/19 08:19:07] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.93%
[24/06/19 08:19:26] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.24%
[24/06/19 08:19:45] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.75%
[24/06/19 08:20:04] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.95%
[24/06/19 08:20:22] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.86%
[24/06/19 08:20:41] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.78%
[24/06/19 08:21:00] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.81%
[24/06/19 08:21:19] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.21%
[24/06/19 08:21:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.06%
[24/06/19 08:21:56] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.21%
[24/06/19 08:21:56] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.08%
[24/06/19 08:21:59] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_082159
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:21:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:21:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 08:21:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:21:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:22:20] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.31%
[24/06/19 08:22:39] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.20%
[24/06/19 08:22:58] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.28%
[24/06/19 08:23:17] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.25%
[24/06/19 08:23:35] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.27%
[24/06/19 08:23:54] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.91%
[24/06/19 08:24:13] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.20%
[24/06/19 08:24:32] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.74%
[24/06/19 08:24:50] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.96%
[24/06/19 08:25:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.79%
[24/06/19 08:25:28] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.69%
[24/06/19 08:25:47] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.80%
[24/06/19 08:26:05] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.26%
[24/06/19 08:26:24] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.08%
[24/06/19 08:26:43] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.19%
[24/06/19 08:26:43] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.06%
[24/06/19 08:26:46] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_082646
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:26:46] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:26:46] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 08:26:46] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:26:46] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:27:11] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.94%
[24/06/19 08:27:32] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.56%
[24/06/19 08:27:54] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.85%
[24/06/19 08:28:16] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.69%
[24/06/19 08:28:38] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.17%
[24/06/19 08:29:00] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.83%
[24/06/19 08:29:22] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.22%
[24/06/19 08:29:44] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.06%
[24/06/19 08:30:06] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.14%
[24/06/19 08:30:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.74%
[24/06/19 08:30:50] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.50%
[24/06/19 08:31:12] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.05%
[24/06/19 08:31:34] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.95%
[24/06/19 08:31:55] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.42%
[24/06/19 08:32:17] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.54%
[24/06/19 08:32:17] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.24%
[24/06/19 08:32:20] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_083220
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:32:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:32:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 08:32:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:32:21] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:32:45] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.94%
[24/06/19 08:33:07] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.54%
[24/06/19 08:33:29] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.86%
[24/06/19 08:33:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.71%
[24/06/19 08:34:13] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.15%
[24/06/19 08:34:35] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.79%
[24/06/19 08:34:57] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.24%
[24/06/19 08:35:19] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.07%
[24/06/19 08:35:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.13%
[24/06/19 08:36:02] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.73%
[24/06/19 08:36:24] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.48%
[24/06/19 08:36:46] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.93%
[24/06/19 08:37:08] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.94%
[24/06/19 08:37:30] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.50%
[24/06/19 08:37:52] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.51%
[24/06/19 08:37:52] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.23%
[24/06/19 08:37:55] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_083755
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:37:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_083758
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:38:01] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_083801
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:38:01] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:38:01] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 08:38:01] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:38:01] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:38:18] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.94%
[24/06/19 08:38:34] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.66%
[24/06/19 08:38:49] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.09%
[24/06/19 08:39:04] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.09%
[24/06/19 08:39:19] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.21%
[24/06/19 08:39:35] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.00%
[24/06/19 08:39:50] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.89%
[24/06/19 08:40:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.44%
[24/06/19 08:40:20] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.15%
[24/06/19 08:40:36] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.19%
[24/06/19 08:40:51] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.91%
[24/06/19 08:41:06] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.63%
[24/06/19 08:41:21] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.35%
[24/06/19 08:41:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.73%
[24/06/19 08:41:52] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.81%
[24/06/19 08:41:52] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.41%
[24/06/19 08:41:55] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_084155
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:41:55] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:41:55] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 08:41:55] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:41:55] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:42:13] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.93%
[24/06/19 08:42:28] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.66%
[24/06/19 08:42:44] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.09%
[24/06/19 08:42:59] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.08%
[24/06/19 08:43:14] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.24%
[24/06/19 08:43:29] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.04%
[24/06/19 08:43:45] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.87%
[24/06/19 08:44:00] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.34%
[24/06/19 08:44:15] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.13%
[24/06/19 08:44:30] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.17%
[24/06/19 08:44:46] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.88%
[24/06/19 08:45:01] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.58%
[24/06/19 08:45:16] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.32%
[24/06/19 08:45:32] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.76%
[24/06/19 08:45:47] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.82%
[24/06/19 08:45:47] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.39%
[24/06/19 08:45:50] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_084550
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:45:50] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:45:50] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 08:45:50] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:45:50] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:46:11] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.29%
[24/06/19 08:46:30] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.03%
[24/06/19 08:46:49] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.19%
[24/06/19 08:47:08] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.31%
[24/06/19 08:47:26] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.22%
[24/06/19 08:47:45] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.95%
[24/06/19 08:48:04] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.26%
[24/06/19 08:48:22] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.74%
[24/06/19 08:48:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.92%
[24/06/19 08:49:00] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.85%
[24/06/19 08:49:19] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.83%
[24/06/19 08:49:37] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.95%
[24/06/19 08:49:56] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.36%
[24/06/19 08:50:15] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.09%
[24/06/19 08:50:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.19%
[24/06/19 08:50:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.08%
[24/06/19 08:50:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_085037
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:50:37] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:50:37] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 08:50:37] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:50:37] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:50:58] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.27%
[24/06/19 08:51:17] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.96%
[24/06/19 08:51:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.20%
[24/06/19 08:51:54] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.32%
[24/06/19 08:52:13] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.24%
[24/06/19 08:52:32] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.92%
[24/06/19 08:52:50] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.24%
[24/06/19 08:53:09] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.75%
[24/06/19 08:53:28] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.93%
[24/06/19 08:53:47] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.85%
[24/06/19 08:54:05] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.81%
[24/06/19 08:54:24] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.95%
[24/06/19 08:54:43] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.33%
[24/06/19 08:55:01] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.11%
[24/06/19 08:55:20] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.22%
[24/06/19 08:55:20] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.07%
[24/06/19 08:55:23] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_085523
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 08:55:23] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 08:55:23] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 08:55:23] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 08:55:23] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 0.0
)
[24/06/19 08:55:48] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.85%
[24/06/19 08:56:10] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.40%
[24/06/19 08:56:32] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.84%
[24/06/19 08:56:54] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.82%
[24/06/19 08:57:16] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.11%
[24/06/19 08:57:37] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.00%
[24/06/19 08:57:59] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.28%
[24/06/19 08:58:21] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.14%
[24/06/19 08:58:43] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.27%
[24/06/19 08:59:05] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.72%
[24/06/19 08:59:27] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.56%
[24/06/19 08:59:49] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.18%
[24/06/19 09:00:11] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.07%
[24/06/19 09:00:33] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.48%
[24/06/19 09:00:55] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.50%
[24/06/19 09:00:55] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.28%
[24/06/19 09:00:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_090058
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:00:58] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:00:58] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 09:00:58] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:00:58] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:01:23] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.85%
[24/06/19 09:01:45] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.43%
[24/06/19 09:02:07] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.76%
[24/06/19 09:02:29] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.79%
[24/06/19 09:02:50] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.13%
[24/06/19 09:03:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.96%
[24/06/19 09:03:34] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.36%
[24/06/19 09:03:56] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.10%
[24/06/19 09:04:18] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.22%
[24/06/19 09:04:40] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.79%
[24/06/19 09:05:02] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.52%
[24/06/19 09:05:24] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.13%
[24/06/19 09:05:46] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.05%
[24/06/19 09:06:08] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.46%
[24/06/19 09:06:30] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.51%
[24/06/19 09:06:30] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.27%
[24/06/19 09:06:33] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_090633
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:06:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_090636
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:06:39] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_090639
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:06:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:06:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:06:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:06:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00031
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:06:57] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.83%
[24/06/19 09:07:12] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.58%
[24/06/19 09:07:27] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.00%
[24/06/19 09:07:43] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.14%
[24/06/19 09:07:58] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.22%
[24/06/19 09:08:13] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.09%
[24/06/19 09:08:29] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.93%
[24/06/19 09:08:44] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.44%
[24/06/19 09:08:59] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.23%
[24/06/19 09:09:14] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.25%
[24/06/19 09:09:30] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.97%
[24/06/19 09:09:45] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.68%
[24/06/19 09:10:00] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.51%
[24/06/19 09:10:15] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.62%
[24/06/19 09:10:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.78%
[24/06/19 09:10:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.42%
[24/06/19 09:10:34] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_091034
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:10:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:10:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:10:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:10:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00031
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:10:52] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.81%
[24/06/19 09:11:07] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.61%
[24/06/19 09:11:22] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.03%
[24/06/19 09:11:37] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.17%
[24/06/19 09:11:53] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.18%
[24/06/19 09:12:08] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.08%
[24/06/19 09:12:24] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.91%
[24/06/19 09:12:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.41%
[24/06/19 09:12:55] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.19%
[24/06/19 09:13:10] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.20%
[24/06/19 09:13:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.95%
[24/06/19 09:13:40] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 35.71%
[24/06/19 09:13:56] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.56%
[24/06/19 09:14:11] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 36.72%
[24/06/19 09:14:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.88%
[24/06/19 09:14:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.43%
[24/06/19 09:14:30] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_091430
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:14:30] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:14:30] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:14:30] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:14:30] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00031
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:14:51] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.17%
[24/06/19 09:15:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.80%
[24/06/19 09:15:30] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.06%
[24/06/19 09:15:48] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.40%
[24/06/19 09:16:08] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.15%
[24/06/19 09:16:27] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.03%
[24/06/19 09:16:46] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.32%
[24/06/19 09:17:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.72%
[24/06/19 09:17:24] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.05%
[24/06/19 09:17:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.85%
[24/06/19 09:18:02] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.87%
[24/06/19 09:18:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.99%
[24/06/19 09:18:40] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.41%
[24/06/19 09:18:59] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.10%
[24/06/19 09:19:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.27%
[24/06/19 09:19:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.08%
[24/06/19 09:19:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_091921
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:19:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:19:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:19:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:19:22] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00031
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:19:43] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.18%
[24/06/19 09:20:02] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.83%
[24/06/19 09:20:21] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.04%
[24/06/19 09:21:33] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_092133
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:21:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:22:38] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 49.50%
[24/06/19 09:23:39] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.42%
[24/06/19 09:24:41] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.93%
[24/06/19 09:25:42] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.38%
[24/06/19 09:26:45] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.93%
[24/06/19 09:27:50] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.65%
[24/06/19 09:28:54] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.02%
[24/06/19 09:29:58] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.11%
[24/06/19 09:31:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.91%
[24/06/19 09:32:08] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.53%
[24/06/19 09:33:13] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.96%
[24/06/19 09:34:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.78%
[24/06/19 09:35:16] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.01%
[24/06/19 09:36:17] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.35%
[24/06/19 09:37:19] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.46%
[24/06/19 09:37:19] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.66%
[24/06/19 09:39:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_093912
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:39:13] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:40:17] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.08%
[24/06/19 09:41:19] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.28%
[24/06/19 09:42:22] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.83%
[24/06/19 09:43:27] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 29.94%
[24/06/19 09:44:30] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.00%
[24/06/19 09:45:33] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.34%
[24/06/19 09:46:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.75%
[24/06/19 09:47:40] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.88%
[24/06/19 09:48:44] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.68%
[24/06/19 09:50:52] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_095052
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:50:52] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:50:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:50:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:50:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:50:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:51:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_095136
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 09:51:36] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 09:52:36] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 49.17%
[24/06/19 09:53:32] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.00%
[24/06/19 09:54:29] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 48.41%
[24/06/19 09:55:26] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.50%
[24/06/19 09:56:23] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 45.76%
[24/06/19 09:57:19] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.63%
[24/06/19 09:58:16] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.91%
[24/06/19 09:59:12] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.58%
[24/06/19 10:00:09] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.36%
[24/06/19 10:01:06] [cifar100c_all_resemble.py:  404]: error % [fog5]: 33.62%
[24/06/19 10:02:03] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.07%
[24/06/19 10:03:00] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.38%
[24/06/19 10:03:59] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 37.86%
[24/06/19 10:04:58] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 32.70%
[24/06/19 10:05:57] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.25%
[24/06/19 10:05:57] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.21%
[24/06/19 10:16:22] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_101622
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 10:16:22] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 10:17:22] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.28%
[24/06/19 10:18:20] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.19%
[24/06/19 10:19:18] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.05%
[24/06/19 10:20:17] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 29.85%
[24/06/19 10:21:16] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 45.94%
[24/06/19 10:22:14] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 31.26%
[24/06/19 10:23:13] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.06%
[24/06/19 10:24:11] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.84%
[24/06/19 10:25:10] [cifar100c_all_resemble.py:  404]: error % [frost5]: 34.67%
[24/06/19 10:26:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 33.24%
[24/06/19 10:27:07] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.34%
[24/06/19 10:28:06] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 30.97%
[24/06/19 10:29:05] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 37.82%
[24/06/19 10:30:03] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 32.22%
[24/06/19 10:31:02] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.52%
[24/06/19 10:31:02] [cifar100c_all_resemble.py:  419]: error % [mean5]: 36.88%
[24/06/19 10:49:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_104958
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 10:49:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 10:50:46] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.44%
[24/06/19 10:51:30] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.41%
[24/06/19 10:52:14] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.79%
[24/06/19 10:52:58] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.85%
[24/06/19 10:53:42] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.00%
[24/06/19 10:54:26] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.97%
[24/06/19 10:55:10] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.91%
[24/06/19 10:55:55] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.53%
[24/06/19 10:56:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.41%
[24/06/19 10:57:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.34%
[24/06/19 10:58:13] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.85%
[24/06/19 10:58:59] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.67%
[24/06/19 10:59:44] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.11%
[24/06/19 11:00:29] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.05%
[24/06/19 11:01:15] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 43.45%
[24/06/19 11:01:15] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.79%
[24/06/19 11:10:18] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_111018
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:10:18] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:11:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 49.94%
[24/06/19 11:11:50] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.94%
[24/06/19 11:12:34] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.68%
[24/06/19 11:13:18] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.43%
[24/06/19 11:14:01] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.53%
[24/06/19 11:14:46] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.39%
[24/06/19 11:15:30] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.72%
[24/06/19 11:16:13] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.10%
[24/06/19 11:16:57] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.97%
[24/06/19 11:17:41] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.59%
[24/06/19 11:18:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.65%
[24/06/19 11:19:09] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.24%
[24/06/19 11:19:52] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.71%
[24/06/19 11:20:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.20%
[24/06/19 11:21:20] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 43.13%
[24/06/19 11:21:20] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.88%
[24/06/19 11:26:48] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_112648
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:26:48] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:27:39] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.64%
[24/06/19 11:28:26] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.76%
[24/06/19 11:29:13] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.38%
[24/06/19 11:30:01] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.00%
[24/06/19 11:30:48] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.01%
[24/06/19 11:31:36] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.07%
[24/06/19 11:32:23] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.58%
[24/06/19 11:33:11] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.43%
[24/06/19 11:33:58] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.16%
[24/06/19 11:34:45] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.74%
[24/06/19 11:35:33] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.37%
[24/06/19 11:36:20] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.18%
[24/06/19 11:37:08] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.30%
[24/06/19 11:37:55] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.72%
[24/06/19 11:38:42] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.93%
[24/06/19 11:38:43] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.08%
[24/06/19 11:49:45] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_114945
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 11:49:45] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:49:45] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 11:49:45] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:49:45] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:50:24] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 55.00%
[24/06/19 11:50:59] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 48.10%
[24/06/19 11:51:33] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.81%
[24/06/19 11:52:07] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.38%
[24/06/19 11:52:43] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.02%
[24/06/19 11:53:18] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.46%
[24/06/19 11:53:52] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.26%
[24/06/19 11:54:27] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.49%
[24/06/19 11:55:01] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.20%
[24/06/19 11:55:35] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.03%
[24/06/19 11:56:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.06%
[24/06/19 11:56:43] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.23%
[24/06/19 11:57:17] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.58%
[24/06/19 11:57:51] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.26%
[24/06/19 11:58:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.15%
[24/06/19 11:58:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.14%
[24/06/19 11:58:29] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_115829
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 11:58:29] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 11:58:29] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 11:58:29] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 11:58:29] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00015
    maximize: False
    weight_decay: 0.0
)
[24/06/19 11:59:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.57%
[24/06/19 11:59:41] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.29%
[24/06/19 12:00:15] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.22%
[24/06/19 12:00:49] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.54%
[24/06/19 12:01:23] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.05%
[24/06/19 12:01:57] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.73%
[24/06/19 12:02:31] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.45%
[24/06/19 12:03:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.44%
[24/06/19 12:03:39] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.36%
[24/06/19 12:04:13] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.46%
[24/06/19 12:04:47] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.05%
[24/06/19 12:05:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.42%
[24/06/19 12:05:55] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.33%
[24/06/19 12:06:29] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.22%
[24/06/19 12:07:03] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.45%
[24/06/19 12:07:03] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.57%
[24/06/19 12:07:06] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_120706
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:07:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:07:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:07:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:07:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:07:44] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.70%
[24/06/19 12:08:18] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.73%
[24/06/19 12:08:52] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.59%
[24/06/19 12:09:26] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.46%
[24/06/19 12:10:00] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.86%
[24/06/19 12:10:34] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.56%
[24/06/19 12:11:08] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.27%
[24/06/19 12:11:42] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.63%
[24/06/19 12:12:16] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.18%
[24/06/19 12:12:50] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.12%
[24/06/19 12:13:24] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.17%
[24/06/19 12:13:59] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.25%
[24/06/19 12:14:33] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.72%
[24/06/19 12:15:07] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.35%
[24/06/19 12:15:41] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.17%
[24/06/19 12:15:41] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.12%
[24/06/19 12:15:44] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_121544
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:15:44] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:15:44] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:15:44] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:15:44] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00016
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:16:22] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.39%
[24/06/19 12:16:56] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.08%
[24/06/19 12:17:30] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.97%
[24/06/19 12:18:04] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.67%
[24/06/19 12:18:38] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.94%
[24/06/19 12:19:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.83%
[24/06/19 12:19:46] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.54%
[24/06/19 12:20:20] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.47%
[24/06/19 12:20:54] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.33%
[24/06/19 12:21:28] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.52%
[24/06/19 12:22:02] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.30%
[24/06/19 12:22:36] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.37%
[24/06/19 12:23:10] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.52%
[24/06/19 12:23:44] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.21%
[24/06/19 12:24:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.46%
[24/06/19 12:24:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.57%
[24/06/19 12:24:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_122421
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:24:21] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:24:21] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:24:21] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:24:21] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:24:59] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.57%
[24/06/19 12:25:33] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.39%
[24/06/19 12:26:07] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.21%
[24/06/19 12:26:41] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.36%
[24/06/19 12:27:15] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.84%
[24/06/19 12:27:49] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.63%
[24/06/19 12:28:23] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.40%
[24/06/19 12:28:57] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.67%
[24/06/19 12:29:31] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.17%
[24/06/19 12:30:05] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.04%
[24/06/19 12:30:39] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.27%
[24/06/19 12:31:13] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.31%
[24/06/19 12:31:47] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.73%
[24/06/19 12:32:21] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.47%
[24/06/19 12:32:55] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.24%
[24/06/19 12:32:55] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.09%
[24/06/19 12:32:58] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_123258
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:32:58] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:32:58] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:32:58] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:32:58] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00017
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:33:36] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.23%
[24/06/19 12:34:10] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.65%
[24/06/19 12:34:44] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.65%
[24/06/19 12:35:18] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.89%
[24/06/19 12:35:52] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.78%
[24/06/19 12:36:26] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.03%
[24/06/19 12:37:00] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.58%
[24/06/19 12:37:34] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.37%
[24/06/19 12:38:08] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.34%
[24/06/19 12:38:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.53%
[24/06/19 12:39:16] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.30%
[24/06/19 12:39:50] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.36%
[24/06/19 12:40:24] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.73%
[24/06/19 12:40:58] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.26%
[24/06/19 12:41:32] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.53%
[24/06/19 12:41:32] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.55%
[24/06/19 12:41:35] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_124135
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:41:35] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:41:35] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:41:35] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:41:35] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:42:13] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.45%
[24/06/19 12:42:47] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.04%
[24/06/19 12:43:21] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.89%
[24/06/19 12:43:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.58%
[24/06/19 12:44:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.90%
[24/06/19 12:45:03] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.76%
[24/06/19 12:45:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.55%
[24/06/19 12:46:11] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.72%
[24/06/19 12:46:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.18%
[24/06/19 12:47:19] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.09%
[24/06/19 12:47:53] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.37%
[24/06/19 12:48:27] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.41%
[24/06/19 12:49:01] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.79%
[24/06/19 12:49:35] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.58%
[24/06/19 12:50:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.13%
[24/06/19 12:50:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.10%
[24/06/19 12:50:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_125012
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:50:13] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:50:13] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:50:13] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:50:13] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00018
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:50:50] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.11%
[24/06/19 12:51:24] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.33%
[24/06/19 12:51:58] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.30%
[24/06/19 12:52:32] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.00%
[24/06/19 12:53:06] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.88%
[24/06/19 12:53:40] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.11%
[24/06/19 12:54:14] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.69%
[24/06/19 12:54:48] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.40%
[24/06/19 12:55:23] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.38%
[24/06/19 12:55:57] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.37%
[24/06/19 12:56:31] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.42%
[24/06/19 12:57:05] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.48%
[24/06/19 12:57:39] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.85%
[24/06/19 12:58:13] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.24%
[24/06/19 12:58:47] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.51%
[24/06/19 12:58:47] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.54%
[24/06/19 12:58:50] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_125850
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 12:58:50] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 12:58:50] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 12:58:50] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 12:58:50] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 12:59:28] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.36%
[24/06/19 13:00:02] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.79%
[24/06/19 13:00:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.69%
[24/06/19 13:01:10] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.67%
[24/06/19 13:01:44] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.85%
[24/06/19 13:02:18] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.88%
[24/06/19 13:02:53] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.65%
[24/06/19 13:03:27] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.84%
[24/06/19 13:04:01] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.10%
[24/06/19 13:04:35] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.11%
[24/06/19 13:05:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.50%
[24/06/19 13:05:43] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.52%
[24/06/19 13:06:17] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.83%
[24/06/19 13:06:51] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.56%
[24/06/19 13:07:25] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.97%
[24/06/19 13:07:25] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.09%
[24/06/19 13:07:28] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_130728
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:07:29] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:07:29] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:07:29] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:07:29] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:08:06] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.93%
[24/06/19 13:08:40] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.95%
[24/06/19 13:09:14] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.05%
[24/06/19 13:09:49] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.15%
[24/06/19 13:10:23] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.76%
[24/06/19 13:10:57] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.24%
[24/06/19 13:11:31] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.78%
[24/06/19 13:12:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.44%
[24/06/19 13:12:39] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.37%
[24/06/19 13:13:13] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.49%
[24/06/19 13:13:47] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.56%
[24/06/19 13:14:21] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.55%
[24/06/19 13:14:55] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.99%
[24/06/19 13:15:30] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.33%
[24/06/19 13:16:04] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.44%
[24/06/19 13:16:04] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.54%
[24/06/19 13:16:07] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_131607
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:16:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:16:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:16:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:16:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:16:45] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.13%
[24/06/19 13:17:19] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.46%
[24/06/19 13:17:53] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.40%
[24/06/19 13:18:27] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.92%
[24/06/19 13:19:01] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.80%
[24/06/19 13:19:35] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.02%
[24/06/19 13:20:09] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.62%
[24/06/19 13:20:43] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.88%
[24/06/19 13:21:17] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.18%
[24/06/19 13:21:51] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.21%
[24/06/19 13:22:26] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.49%
[24/06/19 13:23:00] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.57%
[24/06/19 13:23:34] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.97%
[24/06/19 13:24:08] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.62%
[24/06/19 13:24:42] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.94%
[24/06/19 13:24:42] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.08%
[24/06/19 13:24:45] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_132445
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:24:45] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:24:45] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:24:45] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:24:45] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:25:23] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.77%
[24/06/19 13:25:57] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.60%
[24/06/19 13:26:31] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.78%
[24/06/19 13:27:05] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.13%
[24/06/19 13:27:39] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.69%
[24/06/19 13:28:13] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.36%
[24/06/19 13:28:47] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.87%
[24/06/19 13:29:21] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.44%
[24/06/19 13:29:55] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.39%
[24/06/19 13:30:29] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.62%
[24/06/19 13:31:03] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.63%
[24/06/19 13:31:37] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.61%
[24/06/19 13:32:11] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.07%
[24/06/19 13:32:46] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.32%
[24/06/19 13:33:20] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.34%
[24/06/19 13:33:20] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.51%
[24/06/19 13:33:23] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_133323
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:33:23] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:33:23] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:33:23] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:33:23] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:34:01] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.06%
[24/06/19 13:34:35] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.17%
[24/06/19 13:35:09] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.20%
[24/06/19 13:35:43] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.04%
[24/06/19 13:36:17] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.87%
[24/06/19 13:36:51] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.09%
[24/06/19 13:37:25] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.71%
[24/06/19 13:37:59] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.91%
[24/06/19 13:38:33] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.21%
[24/06/19 13:39:07] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.26%
[24/06/19 13:39:41] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.63%
[24/06/19 13:40:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.64%
[24/06/19 13:40:49] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.15%
[24/06/19 13:41:23] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.62%
[24/06/19 13:41:57] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.92%
[24/06/19 13:41:57] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.10%
[24/06/19 13:42:00] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_134200
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:42:00] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:42:00] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:42:00] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:42:00] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00021
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:42:38] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.60%
[24/06/19 13:43:12] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.46%
[24/06/19 13:43:46] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.52%
[24/06/19 13:44:20] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.27%
[24/06/19 13:44:54] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.57%
[24/06/19 13:45:28] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.48%
[24/06/19 13:46:02] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.98%
[24/06/19 13:46:36] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.42%
[24/06/19 13:47:10] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.35%
[24/06/19 13:47:44] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.57%
[24/06/19 13:48:18] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.68%
[24/06/19 13:48:52] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.73%
[24/06/19 13:49:26] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.20%
[24/06/19 13:50:00] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.35%
[24/06/19 13:50:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.25%
[24/06/19 13:50:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.50%
[24/06/19 13:50:38] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_135038
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:50:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:50:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:50:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:50:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:51:16] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.86%
[24/06/19 13:51:50] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.84%
[24/06/19 13:52:24] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.97%
[24/06/19 13:52:58] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.17%
[24/06/19 13:53:32] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.86%
[24/06/19 13:54:06] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.15%
[24/06/19 13:54:40] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.72%
[24/06/19 13:55:14] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.01%
[24/06/19 13:55:48] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.34%
[24/06/19 13:56:22] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.30%
[24/06/19 13:56:56] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.73%
[24/06/19 13:57:30] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.79%
[24/06/19 13:58:04] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.35%
[24/06/19 13:58:39] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.73%
[24/06/19 13:59:13] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.85%
[24/06/19 13:59:13] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.11%
[24/06/19 13:59:16] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_135916
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 13:59:16] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 13:59:16] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 13:59:16] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 13:59:16] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00022
    maximize: False
    weight_decay: 0.0
)
[24/06/19 13:59:54] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.36%
[24/06/19 14:00:28] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.28%
[24/06/19 14:01:02] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.36%
[24/06/19 14:01:36] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.42%
[24/06/19 14:02:10] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.56%
[24/06/19 14:02:44] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.50%
[24/06/19 14:03:18] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.15%
[24/06/19 14:03:52] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.42%
[24/06/19 14:04:26] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.42%
[24/06/19 14:05:00] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.75%
[24/06/19 14:05:34] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.86%
[24/06/19 14:06:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.78%
[24/06/19 14:06:42] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.07%
[24/06/19 14:07:16] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.42%
[24/06/19 14:07:50] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.42%
[24/06/19 14:07:50] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.52%
[24/06/19 14:07:54] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_140754
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 14:07:54] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 14:07:54] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 14:07:54] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 14:07:54] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 14:08:32] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.64%
[24/06/19 14:09:06] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.57%
[24/06/19 14:09:40] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.78%
[24/06/19 14:10:14] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.27%
[24/06/19 14:10:48] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.76%
[24/06/19 14:11:22] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.31%
[24/06/19 14:11:56] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.91%
[24/06/19 14:12:30] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.91%
[24/06/19 14:13:05] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.27%
[24/06/19 14:13:39] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.39%
[24/06/19 14:14:13] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.84%
[24/06/19 14:14:47] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.90%
[24/06/19 14:15:21] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.54%
[24/06/19 14:15:56] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.91%
[24/06/19 14:16:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.98%
[24/06/19 14:16:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.13%
[24/06/19 14:16:34] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_141634
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 14:16:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 14:16:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 14:16:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 14:16:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00023
    maximize: False
    weight_decay: 0.0
)
[24/06/19 14:17:12] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.18%
[24/06/19 14:17:46] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.26%
[24/06/19 14:18:21] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.29%
[24/06/19 14:18:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.49%
[24/06/19 14:19:29] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.59%
[24/06/19 14:20:03] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.62%
[24/06/19 14:20:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.20%
[24/06/19 14:21:11] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.48%
[24/06/19 14:21:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.41%
[24/06/19 14:22:20] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.76%
[24/06/19 14:22:54] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.89%
[24/06/19 14:23:28] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.99%
[24/06/19 14:24:02] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.29%
[24/06/19 14:24:37] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.41%
[24/06/19 14:25:11] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.33%
[24/06/19 14:25:11] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.55%
[24/06/19 14:25:14] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_142514
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 14:25:15] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 14:25:15] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 14:25:15] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 14:25:15] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 14:25:53] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.45%
[24/06/19 14:26:29] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.34%
[24/06/19 14:27:04] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.78%
[24/06/19 14:27:39] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.33%
[24/06/19 14:28:14] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.88%
[24/06/19 14:28:49] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.30%
[24/06/19 14:29:24] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.03%
[24/06/19 14:29:59] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.02%
[24/06/19 14:30:33] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.28%
[24/06/19 14:31:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.48%
[24/06/19 14:31:44] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.00%
[24/06/19 14:32:19] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.86%
[24/06/19 14:32:55] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.54%
[24/06/19 14:33:30] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.90%
[24/06/19 14:34:05] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.95%
[24/06/19 14:34:05] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.14%
[24/06/19 14:34:09] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_143409
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 14:34:09] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 14:34:09] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 14:34:09] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 14:34:09] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00024
    maximize: False
    weight_decay: 0.0
)
[24/06/19 14:34:48] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.98%
[24/06/19 14:35:23] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.90%
[24/06/19 14:35:59] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.05%
[24/06/19 14:36:34] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.46%
[24/06/19 14:37:09] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.63%
[24/06/19 14:37:44] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.68%
[24/06/19 14:38:19] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.29%
[24/06/19 14:38:54] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.43%
[24/06/19 14:39:29] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.47%
[24/06/19 14:40:05] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.04%
[24/06/19 14:40:40] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.97%
[24/06/19 14:41:15] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.05%
[24/06/19 14:41:50] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.35%
[24/06/19 14:42:26] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.54%
[24/06/19 14:43:01] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.33%
[24/06/19 14:43:01] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.54%
[24/06/19 14:43:04] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_144304
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 14:43:05] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 14:43:05] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 14:43:05] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 14:43:05] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 14:43:44] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.29%
[24/06/19 14:44:19] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.03%
[24/06/19 14:44:54] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.74%
[24/06/19 14:45:29] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.41%
[24/06/19 14:46:05] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.86%
[24/06/19 14:46:40] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.49%
[24/06/19 14:47:15] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.13%
[24/06/19 14:47:50] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.06%
[24/06/19 14:48:25] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.36%
[24/06/19 14:49:01] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.54%
[24/06/19 14:49:36] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.17%
[24/06/19 14:50:11] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.01%
[24/06/19 14:50:46] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.62%
[24/06/19 14:51:22] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.94%
[24/06/19 14:51:57] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.07%
[24/06/19 14:51:57] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.18%
[24/06/19 14:52:00] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_145200
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 14:52:01] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 14:52:01] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 14:52:01] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 14:52:01] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00025
    maximize: False
    weight_decay: 0.0
)
[24/06/19 14:52:39] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.90%
[24/06/19 14:53:15] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.76%
[24/06/19 14:53:50] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.87%
[24/06/19 14:54:26] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.66%
[24/06/19 14:55:01] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.65%
[24/06/19 14:55:36] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.77%
[24/06/19 14:56:12] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.39%
[24/06/19 14:56:47] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.52%
[24/06/19 14:57:22] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.54%
[24/06/19 14:57:57] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.94%
[24/06/19 14:58:33] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.03%
[24/06/19 14:59:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.13%
[24/06/19 14:59:43] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.41%
[24/06/19 15:00:18] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.60%
[24/06/19 15:00:54] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.33%
[24/06/19 15:00:54] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.57%
[24/06/19 15:00:57] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_150057
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:00:58] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:00:58] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:00:58] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:00:58] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:01:36] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.20%
[24/06/19 15:02:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.86%
[24/06/19 15:02:47] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.55%
[24/06/19 15:03:22] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.48%
[24/06/19 15:03:57] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.95%
[24/06/19 15:04:32] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.58%
[24/06/19 15:05:08] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.25%
[24/06/19 15:05:43] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.14%
[24/06/19 15:06:18] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.48%
[24/06/19 15:06:53] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.63%
[24/06/19 15:07:28] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.32%
[24/06/19 15:08:03] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.12%
[24/06/19 15:08:38] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.73%
[24/06/19 15:09:13] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.09%
[24/06/19 15:09:48] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.08%
[24/06/19 15:09:49] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.23%
[24/06/19 15:09:52] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_150952
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:09:52] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:09:52] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:09:52] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:09:52] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00026
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:10:30] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.72%
[24/06/19 15:11:05] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.54%
[24/06/19 15:11:40] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.83%
[24/06/19 15:12:16] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.71%
[24/06/19 15:12:51] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.73%
[24/06/19 15:13:26] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.81%
[24/06/19 15:14:01] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.42%
[24/06/19 15:14:37] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.66%
[24/06/19 15:15:12] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.57%
[24/06/19 15:15:47] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.05%
[24/06/19 15:16:22] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.18%
[24/06/19 15:16:57] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.29%
[24/06/19 15:17:32] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.48%
[24/06/19 15:18:07] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.67%
[24/06/19 15:18:42] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.41%
[24/06/19 15:18:43] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.60%
[24/06/19 15:18:46] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_151846
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:18:46] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:18:46] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:18:46] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:18:46] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:19:25] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.07%
[24/06/19 15:20:00] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.54%
[24/06/19 15:20:35] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.49%
[24/06/19 15:21:11] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.68%
[24/06/19 15:21:46] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.06%
[24/06/19 15:22:21] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.73%
[24/06/19 15:22:56] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.30%
[24/06/19 15:23:31] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.16%
[24/06/19 15:24:07] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.53%
[24/06/19 15:24:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.69%
[24/06/19 15:25:18] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.45%
[24/06/19 15:25:53] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.22%
[24/06/19 15:26:28] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.81%
[24/06/19 15:27:03] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.17%
[24/06/19 15:27:39] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.10%
[24/06/19 15:27:39] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.27%
[24/06/19 15:27:42] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_152742
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:27:42] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:27:42] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:27:42] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:27:42] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:28:21] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.57%
[24/06/19 15:28:57] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.43%
[24/06/19 15:29:32] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.81%
[24/06/19 15:30:07] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.83%
[24/06/19 15:30:42] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.70%
[24/06/19 15:31:17] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.90%
[24/06/19 15:31:53] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.42%
[24/06/19 15:32:28] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.50%
[24/06/19 15:33:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.63%
[24/06/19 15:33:38] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.21%
[24/06/19 15:34:13] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.37%
[24/06/19 15:34:48] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.34%
[24/06/19 15:35:24] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.54%
[24/06/19 15:35:59] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.78%
[24/06/19 15:36:34] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.34%
[24/06/19 15:36:34] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.62%
[24/06/19 15:36:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_153637
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:36:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:36:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:36:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:36:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:37:16] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.93%
[24/06/19 15:37:52] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.47%
[24/06/19 15:38:27] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.53%
[24/06/19 15:39:02] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.77%
[24/06/19 15:39:37] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.10%
[24/06/19 15:40:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.81%
[24/06/19 15:40:48] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.33%
[24/06/19 15:41:24] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.16%
[24/06/19 15:41:59] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.64%
[24/06/19 15:42:34] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.77%
[24/06/19 15:43:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.45%
[24/06/19 15:43:44] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.39%
[24/06/19 15:44:20] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.98%
[24/06/19 15:44:56] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.32%
[24/06/19 15:45:31] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.16%
[24/06/19 15:45:31] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.32%
[24/06/19 15:45:34] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_154534
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:45:34] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:45:34] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:45:34] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:45:34] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00028
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:46:13] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.48%
[24/06/19 15:46:48] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.23%
[24/06/19 15:47:23] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.63%
[24/06/19 15:47:59] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.97%
[24/06/19 15:48:34] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.77%
[24/06/19 15:49:09] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.07%
[24/06/19 15:49:44] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.42%
[24/06/19 15:50:18] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.61%
[24/06/19 15:50:52] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.71%
[24/06/19 15:51:27] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.18%
[24/06/19 15:52:01] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.38%
[24/06/19 15:52:36] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.54%
[24/06/19 15:53:10] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.54%
[24/06/19 15:53:44] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.91%
[24/06/19 15:54:18] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.29%
[24/06/19 15:54:18] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.65%
[24/06/19 15:54:22] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_155422
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 15:54:22] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 15:54:22] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 15:54:22] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 15:54:22] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 15:55:00] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.65%
[24/06/19 15:55:34] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.37%
[24/06/19 15:56:08] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.35%
[24/06/19 15:56:43] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.00%
[24/06/19 15:57:18] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.01%
[24/06/19 15:57:53] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.90%
[24/06/19 15:58:29] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 30.37%
[24/06/19 15:59:04] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.22%
[24/06/19 15:59:39] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.72%
[24/06/19 16:00:14] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.77%
[24/06/19 16:00:50] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.53%
[24/06/19 16:01:25] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.51%
[24/06/19 16:02:00] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.08%
[24/06/19 16:02:35] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.34%
[24/06/19 16:03:09] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.33%
[24/06/19 16:03:09] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.34%
[24/06/19 16:03:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_160312
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 16:03:12] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 16:03:12] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 640, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(320, 640, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=10240, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(640, 640, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=640, out_features=100, bias=True)
  )
)
[24/06/19 16:03:12] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 16:03:12] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00029
    maximize: False
    weight_decay: 0.0
)
[24/06/19 16:27:48] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_162748
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 16:27:49] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 16:27:49] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2048, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4096, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=8192, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=512, out_features=100, bias=True)
  )
)
[24/06/19 16:27:49] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 16:27:49] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 16:28:08] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_162808
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 16:28:09] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 16:28:09] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2048, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4096, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=8192, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=512, out_features=100, bias=True)
  )
)
[24/06/19 16:28:09] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 16:28:09] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 16:28:37] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.63%
[24/06/19 16:29:02] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.64%
[24/06/19 16:29:27] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.59%
[24/06/19 16:29:52] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 32.78%
[24/06/19 16:30:17] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.96%
[24/06/19 16:30:42] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.07%
[24/06/19 16:31:07] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.24%
[24/06/19 16:31:32] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.64%
[24/06/19 16:31:58] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.20%
[24/06/19 16:32:23] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.21%
[24/06/19 16:32:48] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.78%
[24/06/19 16:33:14] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.92%
[24/06/19 16:33:39] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.19%
[24/06/19 16:34:05] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.23%
[24/06/19 16:34:30] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.83%
[24/06/19 16:34:30] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.19%
[24/06/19 16:40:38] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_164038
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 16:40:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 16:40:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2048, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4096, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=8192, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=512, out_features=100, bias=True)
  )
)
[24/06/19 16:40:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 16:40:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 16:41:07] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.00%
[24/06/19 16:41:32] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.92%
[24/06/19 16:41:57] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.37%
[24/06/19 16:42:22] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.05%
[24/06/19 16:42:47] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.03%
[24/06/19 16:43:12] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.03%
[24/06/19 16:43:37] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.05%
[24/06/19 16:44:02] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.96%
[24/06/19 16:44:27] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.20%
[24/06/19 16:44:52] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.09%
[24/06/19 16:45:17] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.52%
[24/06/19 16:45:42] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.61%
[24/06/19 16:46:07] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 41.00%
[24/06/19 16:46:33] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.83%
[24/06/19 16:46:59] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.66%
[24/06/19 16:46:59] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.49%
[24/06/19 16:53:24] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_165324
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 16:53:24] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 16:53:24] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 16:53:24] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 16:53:24] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 16:53:49] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.21%
[24/06/19 16:54:11] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.13%
[24/06/19 16:54:33] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 53.29%
[24/06/19 16:54:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.50%
[24/06/19 16:55:18] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.20%
[24/06/19 16:55:39] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.61%
[24/06/19 16:56:01] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.16%
[24/06/19 16:56:23] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.09%
[24/06/19 16:56:45] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.05%
[24/06/19 16:57:07] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.56%
[24/06/19 16:57:29] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.32%
[24/06/19 16:57:51] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.94%
[24/06/19 16:58:13] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.86%
[24/06/19 16:58:35] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.26%
[24/06/19 16:58:57] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.35%
[24/06/19 16:58:57] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.24%
[24/06/19 17:10:18] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_171018
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 17:10:19] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 17:10:19] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 17:10:19] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 17:10:19] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 17:10:44] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 56.02%
[24/06/19 17:11:07] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 49.11%
[24/06/19 17:11:29] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.20%
[24/06/19 17:11:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.65%
[24/06/19 17:12:13] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 51.21%
[24/06/19 17:12:36] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 35.73%
[24/06/19 17:12:58] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.55%
[24/06/19 17:13:20] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.38%
[24/06/19 17:13:42] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.07%
[24/06/19 17:14:04] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.28%
[24/06/19 17:14:27] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.47%
[24/06/19 17:14:49] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.13%
[24/06/19 17:15:11] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.10%
[24/06/19 17:15:33] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.39%
[24/06/19 17:15:56] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 46.89%
[24/06/19 17:15:56] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.01%
[24/06/19 17:23:38] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_172338
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 17:23:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 17:24:20] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.30%
[24/06/19 17:25:00] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.41%
[24/06/19 17:25:39] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.20%
[24/06/19 17:26:19] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.88%
[24/06/19 17:26:58] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.32%
[24/06/19 17:27:38] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.37%
[24/06/19 17:28:17] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.96%
[24/06/19 17:28:57] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.76%
[24/06/19 17:29:36] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.27%
[24/06/19 17:30:16] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.28%
[24/06/19 17:30:55] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.72%
[24/06/19 17:31:34] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.54%
[24/06/19 17:32:14] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.87%
[24/06/19 17:32:54] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.07%
[24/06/19 17:33:33] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 43.95%
[24/06/19 17:33:33] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.99%
[24/06/19 19:06:59] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_190659
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:06:59] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:07:39] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 50.65%
[24/06/19 19:08:17] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.84%
[24/06/19 19:08:54] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.79%
[24/06/19 19:09:32] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.29%
[24/06/19 19:10:10] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.51%
[24/06/19 19:10:47] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.18%
[24/06/19 19:11:25] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.51%
[24/06/19 19:12:02] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.04%
[24/06/19 19:12:40] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.09%
[24/06/19 19:13:17] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.33%
[24/06/19 19:13:55] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.87%
[24/06/19 19:14:32] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.30%
[24/06/19 19:15:10] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.23%
[24/06/19 19:15:48] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.27%
[24/06/19 19:16:25] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 43.11%
[24/06/19 19:16:25] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.93%
[24/06/19 19:20:03] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_192003
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:20:03] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:20:46] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.29%
[24/06/19 19:21:26] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.41%
[24/06/19 19:22:06] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.20%
[24/06/19 19:22:45] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.82%
[24/06/19 19:23:25] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.34%
[24/06/19 19:24:04] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.33%
[24/06/19 19:24:44] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.96%
[24/06/19 19:25:23] [cifar100c_all_resemble.py:  404]: error % [snow5]: 37.76%
[24/06/19 19:26:03] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.22%
[24/06/19 19:26:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.23%
[24/06/19 19:27:21] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.69%
[24/06/19 19:28:00] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.57%
[24/06/19 19:28:40] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.81%
[24/06/19 19:29:19] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 32.99%
[24/06/19 19:29:58] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.00%
[24/06/19 19:29:58] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.97%
[24/06/19 19:30:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_193036
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 19:30:36] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:30:36] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 19:30:36] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:30:36] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:30:58] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 57.39%
[24/06/19 19:31:17] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 50.24%
[24/06/19 19:31:36] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 55.08%
[24/06/19 19:31:55] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.89%
[24/06/19 19:32:14] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 50.85%
[24/06/19 19:32:33] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.80%
[24/06/19 19:32:52] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.26%
[24/06/19 19:33:11] [cifar100c_all_resemble.py:  404]: error % [snow5]: 40.33%
[24/06/19 19:33:31] [cifar100c_all_resemble.py:  404]: error % [frost5]: 38.03%
[24/06/19 19:33:50] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.39%
[24/06/19 19:34:09] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 29.05%
[24/06/19 19:34:28] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.22%
[24/06/19 19:34:48] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 42.02%
[24/06/19 19:35:07] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.67%
[24/06/19 19:35:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 47.25%
[24/06/19 19:35:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 41.16%
[24/06/19 19:37:14] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_193714
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 19:37:14] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:37:14] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 96, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1536, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(96, 192, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(96, 192, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3072, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(192, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(192, 384, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(192, 384, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=6144, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(384, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=384, out_features=100, bias=True)
  )
)
[24/06/19 19:37:14] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:37:14] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:37:36] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 54.55%
[24/06/19 19:37:55] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.64%
[24/06/19 19:38:14] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.54%
[24/06/19 19:38:33] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 33.02%
[24/06/19 19:38:52] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 49.29%
[24/06/19 19:39:11] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 34.71%
[24/06/19 19:39:30] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 31.17%
[24/06/19 19:39:48] [cifar100c_all_resemble.py:  404]: error % [snow5]: 39.70%
[24/06/19 19:40:07] [cifar100c_all_resemble.py:  404]: error % [frost5]: 37.90%
[24/06/19 19:40:26] [cifar100c_all_resemble.py:  404]: error % [fog5]: 36.71%
[24/06/19 19:40:45] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 28.64%
[24/06/19 19:41:04] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.59%
[24/06/19 19:41:23] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.09%
[24/06/19 19:41:42] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 35.03%
[24/06/19 19:42:00] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 45.25%
[24/06/19 19:42:01] [cifar100c_all_resemble.py:  419]: error % [mean5]: 40.06%
[24/06/19 19:44:32] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_194432
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 19:44:32] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:44:32] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 19:44:32] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:44:32] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:44:50] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 58.79%
[24/06/19 19:45:06] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 52.68%
[24/06/19 19:45:21] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 57.44%
[24/06/19 19:45:37] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 34.82%
[24/06/19 19:45:52] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 52.84%
[24/06/19 19:46:08] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 36.70%
[24/06/19 19:46:23] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 32.66%
[24/06/19 19:46:39] [cifar100c_all_resemble.py:  404]: error % [snow5]: 41.27%
[24/06/19 19:46:54] [cifar100c_all_resemble.py:  404]: error % [frost5]: 39.73%
[24/06/19 19:47:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 37.97%
[24/06/19 19:47:25] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 30.17%
[24/06/19 19:47:40] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.99%
[24/06/19 19:47:56] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 43.85%
[24/06/19 19:48:11] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 37.27%
[24/06/19 19:48:26] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 48.67%
[24/06/19 19:48:26] [cifar100c_all_resemble.py:  419]: error % [mean5]: 42.66%
[24/06/19 19:50:53] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_195053
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 19:50:53] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 19:51:29] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 53.36%
[24/06/19 19:52:01] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 47.43%
[24/06/19 19:52:34] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 52.67%
[24/06/19 19:53:06] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.39%
[24/06/19 19:53:38] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 48.71%
[24/06/19 19:54:11] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.55%
[24/06/19 19:54:43] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.73%
[24/06/19 19:55:15] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.28%
[24/06/19 19:55:48] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.29%
[24/06/19 19:56:20] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.21%
[24/06/19 19:56:53] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.22%
[24/06/19 19:57:27] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 33.25%
[24/06/19 19:57:58] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 40.07%
[24/06/19 19:58:28] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.91%
[24/06/19 19:58:59] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 44.67%
[24/06/19 19:58:59] [cifar100c_all_resemble.py:  419]: error % [mean5]: 39.05%
[24/06/19 20:00:56] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_200056
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:00:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:01:31] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.59%
[24/06/19 20:02:01] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.73%
[24/06/19 20:02:32] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.45%
[24/06/19 20:03:03] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 31.44%
[24/06/19 20:03:33] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.76%
[24/06/19 20:04:04] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 33.73%
[24/06/19 20:04:34] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 29.81%
[24/06/19 20:05:05] [cifar100c_all_resemble.py:  404]: error % [snow5]: 38.02%
[24/06/19 20:05:36] [cifar100c_all_resemble.py:  404]: error % [frost5]: 36.52%
[24/06/19 20:06:06] [cifar100c_all_resemble.py:  404]: error % [fog5]: 35.13%
[24/06/19 20:06:37] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 27.84%
[24/06/19 20:07:08] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 34.26%
[24/06/19 20:07:40] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 39.24%
[24/06/19 20:08:12] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 34.28%
[24/06/19 20:08:44] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 43.77%
[24/06/19 20:08:44] [cifar100c_all_resemble.py:  419]: error % [mean5]: 38.77%
[24/06/19 20:13:37] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_201337
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:13:38] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:14:26] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 52.13%
[24/06/19 20:15:14] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 46.10%
[24/06/19 20:16:03] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 51.26%
[24/06/19 20:16:51] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.50%
[24/06/19 20:17:40] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 47.09%
[24/06/19 20:18:29] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.36%
[24/06/19 20:19:18] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.81%
[24/06/19 20:20:06] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.92%
[24/06/19 20:20:54] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.43%
[24/06/19 20:21:42] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.23%
[24/06/19 20:22:31] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.48%
[24/06/19 20:23:19] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.69%
[24/06/19 20:24:08] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.51%
[24/06/19 20:24:56] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.13%
[24/06/19 20:25:45] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 43.33%
[24/06/19 20:25:45] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.86%
[24/06/19 20:34:06] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_203406
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:34:06] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:34:07] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:34:07] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:34:07] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:34:07] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:34:54] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 51.08%
[24/06/19 20:35:40] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 45.55%
[24/06/19 20:36:26] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 50.53%
[24/06/19 20:37:12] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.35%
[24/06/19 20:37:58] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.65%
[24/06/19 20:38:43] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.44%
[24/06/19 20:39:29] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.75%
[24/06/19 20:40:15] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.86%
[24/06/19 20:41:02] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.40%
[24/06/19 20:41:48] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.33%
[24/06/19 20:42:34] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.77%
[24/06/19 20:43:20] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.30%
[24/06/19 20:44:06] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.19%
[24/06/19 20:44:52] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 33.19%
[24/06/19 20:45:38] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.78%
[24/06/19 20:45:38] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.68%
[24/06/19 20:48:57] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_204857
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1280, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(80, 80, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(80, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(80, 160, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(80, 160, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=2560, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(160, 160, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(160, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(160, 320, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(160, 320, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=5120, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(320, 320, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(320, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=320, out_features=100, bias=True)
  )
)
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 20:48:57] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 20:50:04] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 49.29%
[24/06/19 20:51:09] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 44.83%
[24/06/19 20:52:13] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.30%
[24/06/19 20:53:18] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 29.95%
[24/06/19 20:54:22] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.30%
[24/06/19 20:55:27] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 31.82%
[24/06/19 20:56:32] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.56%
[24/06/19 20:57:37] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.46%
[24/06/19 20:58:41] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.49%
[24/06/19 20:59:46] [cifar100c_all_resemble.py:  404]: error % [fog5]: 33.79%
[24/06/19 21:00:50] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.53%
[24/06/19 21:01:55] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 31.98%
[24/06/19 21:02:57] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 37.73%
[24/06/19 21:03:58] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 32.78%
[24/06/19 21:05:00] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.34%
[24/06/19 21:05:00] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.14%
[24/06/19 21:39:38] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240619_213938
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  178]: test-time adaptation: TENT
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 112, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=1792, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(112, 112, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(112, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(112, 224, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(112, 224, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=3584, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(224, 224, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(224, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(224, 448, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(224, 448, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=7168, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(448, 448, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(448, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=448, out_features=100, bias=True)
  )
)
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/19 21:39:39] [cifar100c_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/19 21:40:28] [cifar100c_all_resemble.py:  404]: error % [gaussian_noise5]: 49.92%
[24/06/19 21:41:13] [cifar100c_all_resemble.py:  404]: error % [shot_noise5]: 43.83%
[24/06/19 21:41:58] [cifar100c_all_resemble.py:  404]: error % [impulse_noise5]: 49.92%
[24/06/19 21:42:42] [cifar100c_all_resemble.py:  404]: error % [defocus_blur5]: 30.78%
[24/06/19 21:43:27] [cifar100c_all_resemble.py:  404]: error % [glass_blur5]: 46.45%
[24/06/19 21:44:11] [cifar100c_all_resemble.py:  404]: error % [motion_blur5]: 32.62%
[24/06/19 21:44:56] [cifar100c_all_resemble.py:  404]: error % [zoom_blur5]: 28.98%
[24/06/19 21:45:40] [cifar100c_all_resemble.py:  404]: error % [snow5]: 36.32%
[24/06/19 21:46:25] [cifar100c_all_resemble.py:  404]: error % [frost5]: 35.58%
[24/06/19 21:47:09] [cifar100c_all_resemble.py:  404]: error % [fog5]: 34.44%
[24/06/19 21:47:53] [cifar100c_all_resemble.py:  404]: error % [brightness5]: 26.96%
[24/06/19 21:48:37] [cifar100c_all_resemble.py:  404]: error % [contrast5]: 32.36%
[24/06/19 21:49:21] [cifar100c_all_resemble.py:  404]: error % [elastic_transform5]: 38.58%
[24/06/19 21:50:06] [cifar100c_all_resemble.py:  404]: error % [pixelate5]: 32.76%
[24/06/19 21:50:52] [cifar100c_all_resemble.py:  404]: error % [jpeg_compression5]: 42.82%
[24/06/19 21:50:52] [cifar100c_all_resemble.py:  419]: error % [mean5]: 37.49%
[24/06/20 09:07:32] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240620_090732
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/20 09:07:33] [cifar100c_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/20 09:07:33] [cifar100c_all_resemble.py:  583]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2304, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 288, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(144, 288, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4608, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 576, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(288, 576, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=9216, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=576, out_features=100, bias=True)
  )
)
[24/06/20 09:07:33] [cifar100c_all_resemble.py:  584]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/20 09:07:33] [cifar100c_all_resemble.py:  585]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/20 09:08:06] [cifar100c_all_resemble.py:  405]: error % [gaussian_noise5]: 52.99%
[24/06/20 09:08:36] [cifar100c_all_resemble.py:  405]: error % [shot_noise5]: 45.98%
[24/06/20 09:09:06] [cifar100c_all_resemble.py:  405]: error % [impulse_noise5]: 52.84%
[24/06/20 09:09:36] [cifar100c_all_resemble.py:  405]: error % [defocus_blur5]: 32.70%
[24/06/20 09:10:06] [cifar100c_all_resemble.py:  405]: error % [glass_blur5]: 49.07%
[24/06/20 09:10:36] [cifar100c_all_resemble.py:  405]: error % [motion_blur5]: 34.08%
[24/06/20 09:11:07] [cifar100c_all_resemble.py:  405]: error % [zoom_blur5]: 30.31%
[24/06/20 09:11:37] [cifar100c_all_resemble.py:  405]: error % [snow5]: 37.95%
[24/06/20 09:12:07] [cifar100c_all_resemble.py:  405]: error % [frost5]: 36.79%
[24/06/20 09:12:38] [cifar100c_all_resemble.py:  405]: error % [fog5]: 35.61%
[24/06/20 09:13:08] [cifar100c_all_resemble.py:  405]: error % [brightness5]: 28.66%
[24/06/20 09:13:38] [cifar100c_all_resemble.py:  405]: error % [contrast5]: 32.87%
[24/06/20 09:14:08] [cifar100c_all_resemble.py:  405]: error % [elastic_transform5]: 42.02%
[24/06/20 09:14:38] [cifar100c_all_resemble.py:  405]: error % [pixelate5]: 35.54%
[24/06/20 09:15:08] [cifar100c_all_resemble.py:  405]: error % [jpeg_compression5]: 46.41%
[24/06/20 09:15:08] [cifar100c_all_resemble.py:  420]: error % [mean5]: 39.59%
[24/06/20 09:19:36] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240620_091936
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/20 09:19:37] [cifar100c_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/20 09:19:37] [cifar100c_all_resemble.py:  583]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2304, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 288, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(144, 288, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4608, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 576, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(288, 576, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=9216, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=576, out_features=100, bias=True)
  )
)
[24/06/20 09:19:37] [cifar100c_all_resemble.py:  584]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/20 09:19:37] [cifar100c_all_resemble.py:  585]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/20 09:20:11] [cifar100c_all_resemble.py:  405]: error % [gaussian_noise5]: 51.41%
[24/06/20 09:20:42] [cifar100c_all_resemble.py:  405]: error % [shot_noise5]: 44.51%
[24/06/20 09:21:13] [cifar100c_all_resemble.py:  405]: error % [impulse_noise5]: 51.36%
[24/06/20 09:21:43] [cifar100c_all_resemble.py:  405]: error % [defocus_blur5]: 32.20%
[24/06/20 09:22:14] [cifar100c_all_resemble.py:  405]: error % [glass_blur5]: 47.96%
[24/06/20 09:22:46] [cifar100c_all_resemble.py:  405]: error % [motion_blur5]: 33.62%
[24/06/20 09:23:16] [cifar100c_all_resemble.py:  405]: error % [zoom_blur5]: 29.65%
[24/06/20 09:23:47] [cifar100c_all_resemble.py:  405]: error % [snow5]: 37.14%
[24/06/20 09:24:18] [cifar100c_all_resemble.py:  405]: error % [frost5]: 36.45%
[24/06/20 09:24:49] [cifar100c_all_resemble.py:  405]: error % [fog5]: 34.93%
[24/06/20 09:25:20] [cifar100c_all_resemble.py:  405]: error % [brightness5]: 28.16%
[24/06/20 09:25:51] [cifar100c_all_resemble.py:  405]: error % [contrast5]: 33.11%
[24/06/20 09:26:22] [cifar100c_all_resemble.py:  405]: error % [elastic_transform5]: 41.26%
[24/06/20 09:26:53] [cifar100c_all_resemble.py:  405]: error % [pixelate5]: 34.79%
[24/06/20 09:27:23] [cifar100c_all_resemble.py:  405]: error % [jpeg_compression5]: 45.26%
[24/06/20 09:27:23] [cifar100c_all_resemble.py:  420]: error % [mean5]: 38.79%
[24/06/20 11:05:25] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240620_110525
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/20 11:05:26] [cifar100c_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/20 11:05:26] [cifar100c_all_resemble.py:  583]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2304, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 288, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(144, 288, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4608, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 576, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(288, 576, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=9216, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=576, out_features=100, bias=True)
  )
)
[24/06/20 11:05:26] [cifar100c_all_resemble.py:  584]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/20 11:05:26] [cifar100c_all_resemble.py:  585]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/20 11:06:00] [cifar100c_all_resemble.py:  405]: error % [gaussian_noise5]: 50.45%
[24/06/20 11:06:31] [cifar100c_all_resemble.py:  405]: error % [shot_noise5]: 44.30%
[24/06/20 11:07:02] [cifar100c_all_resemble.py:  405]: error % [impulse_noise5]: 50.99%
[24/06/20 11:07:33] [cifar100c_all_resemble.py:  405]: error % [defocus_blur5]: 32.76%
[24/06/20 11:08:04] [cifar100c_all_resemble.py:  405]: error % [glass_blur5]: 47.54%
[24/06/20 11:08:35] [cifar100c_all_resemble.py:  405]: error % [motion_blur5]: 33.61%
[24/06/20 11:09:07] [cifar100c_all_resemble.py:  405]: error % [zoom_blur5]: 30.18%
[24/06/20 11:09:38] [cifar100c_all_resemble.py:  405]: error % [snow5]: 37.36%
[24/06/20 11:10:09] [cifar100c_all_resemble.py:  405]: error % [frost5]: 36.32%
[24/06/20 11:10:40] [cifar100c_all_resemble.py:  405]: error % [fog5]: 35.21%
[24/06/20 11:11:12] [cifar100c_all_resemble.py:  405]: error % [brightness5]: 28.44%
[24/06/20 11:11:42] [cifar100c_all_resemble.py:  405]: error % [contrast5]: 33.98%
[24/06/20 11:12:13] [cifar100c_all_resemble.py:  405]: error % [elastic_transform5]: 40.80%
[24/06/20 11:12:44] [cifar100c_all_resemble.py:  405]: error % [pixelate5]: 34.62%
[24/06/20 11:13:14] [cifar100c_all_resemble.py:  405]: error % [jpeg_compression5]: 44.66%
[24/06/20 11:13:14] [cifar100c_all_resemble.py:  420]: error % [mean5]: 38.75%
[24/06/21 11:22:03] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240621_112203
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/21 11:22:03] [tinyImagenetC_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/21 11:22:03] [tinyImagenetC_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 144, kernel_size=(1, 1), stride=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=2304, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(144, 144, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(144, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(144, 288, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(144, 288, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=4608, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(288, 288, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(288, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(288, 576, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(288, 576, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=2, stride=2, padding=0)
              (2): Linear(in_features=9216, out_features=100, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(576, 576, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(576, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=576, out_features=100, bias=True)
  )
)
[24/06/21 11:22:03] [tinyImagenetC_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/21 11:22:03] [tinyImagenetC_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/21 11:24:21] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240621_112421
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/21 11:24:57] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240621_112457
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/21 11:25:51] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240621_112551
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/21 11:25:52] [tinyImagenetC_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/21 11:25:52] [tinyImagenetC_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=16, stride=16, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=16, stride=16, padding=0)
              (2): Linear(in_features=256, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=512, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=1024, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=64, out_features=200, bias=True)
  )
)
[24/06/21 11:25:52] [tinyImagenetC_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/21 11:25:52] [tinyImagenetC_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/21 11:28:12] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240621_112812
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/21 11:28:12] [tinyImagenetC_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/21 11:28:12] [tinyImagenetC_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=16, stride=16, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=16, stride=16, padding=0)
              (2): Linear(in_features=256, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=512, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=1024, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=64, out_features=200, bias=True)
  )
)
[24/06/21 11:28:12] [tinyImagenetC_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/21 11:28:12] [tinyImagenetC_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/21 11:32:45] [conf.py:  215]: BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar100
  NUM_EX: 10000
  SEVERITY: [5]
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATA_DIR: ./data
DESC: 
LOG_DEST: tent_Adam_0.001_bs128_em0.2.txt
LOG_TIME: 240621_113245
MODEL:
  ADAPTATION: tent
  ARCH: Standard
  EPISODIC: False
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
RESET_CONSTANT_EM: 0.2
RNG_SEED: 1
SAVE_DIR: ./output2
TEST:
  BATCH_SIZE: 128
[24/06/21 11:32:45] [tinyImagenetC_all_resemble.py:  179]: test-time adaptation: TENT
[24/06/21 11:32:45] [tinyImagenetC_all_resemble.py:  582]: model for adaptation: DataParallel(
  (module): WideResNet(
    (conv1): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
    (block1): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=16, stride=16, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=16, stride=16, padding=0)
              (2): Linear(in_features=256, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block2): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(16, 32, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=8, stride=8, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=8, stride=8, padding=0)
              (2): Linear(in_features=512, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (block3): NetworkBlock(
      (layer): Sequential(
        (0): BasicBlock(
          (bn1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (convShortcut): Conv2d(32, 64, kernel_size=(1, 1), stride=(2, 2), bias=False)
          (output): InternalClassifier(
            (layers): Sequential(
              (0): MaxPool2d(kernel_size=4, stride=4, padding=0, dilation=1, ceil_mode=False)
              (1): AvgPool2d(kernel_size=4, stride=4, padding=0)
              (2): Linear(in_features=1024, out_features=200, bias=True)
            )
          )
        )
        (1): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (2): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
        (3): BasicBlock(
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu1): ReLU(inplace=True)
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
          (relu2): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
        )
      )
    )
    (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=False)
    (relu): ReLU(inplace=True)
    (fc): Linear(in_features=64, out_features=200, bias=True)
  )
)
[24/06/21 11:32:45] [tinyImagenetC_all_resemble.py:  583]: params for adaptation: ['module.block1.layer.0.bn1.weight', 'module.block1.layer.0.bn1.bias', 'module.block1.layer.0.bn2.weight', 'module.block1.layer.0.bn2.bias', 'module.block1.layer.1.bn1.weight', 'module.block1.layer.1.bn1.bias', 'module.block1.layer.1.bn2.weight', 'module.block1.layer.1.bn2.bias', 'module.block1.layer.2.bn1.weight', 'module.block1.layer.2.bn1.bias', 'module.block1.layer.2.bn2.weight', 'module.block1.layer.2.bn2.bias', 'module.block1.layer.3.bn1.weight', 'module.block1.layer.3.bn1.bias', 'module.block1.layer.3.bn2.weight', 'module.block1.layer.3.bn2.bias', 'module.block2.layer.0.bn1.weight', 'module.block2.layer.0.bn1.bias', 'module.block2.layer.0.bn2.weight', 'module.block2.layer.0.bn2.bias', 'module.block2.layer.1.bn1.weight', 'module.block2.layer.1.bn1.bias', 'module.block2.layer.1.bn2.weight', 'module.block2.layer.1.bn2.bias', 'module.block2.layer.2.bn1.weight', 'module.block2.layer.2.bn1.bias', 'module.block2.layer.2.bn2.weight', 'module.block2.layer.2.bn2.bias', 'module.block2.layer.3.bn1.weight', 'module.block2.layer.3.bn1.bias', 'module.block2.layer.3.bn2.weight', 'module.block2.layer.3.bn2.bias', 'module.block3.layer.0.bn1.weight', 'module.block3.layer.0.bn1.bias', 'module.block3.layer.0.bn2.weight', 'module.block3.layer.0.bn2.bias', 'module.block3.layer.1.bn1.weight', 'module.block3.layer.1.bn1.bias', 'module.block3.layer.1.bn2.weight', 'module.block3.layer.1.bn2.bias', 'module.block3.layer.2.bn1.weight', 'module.block3.layer.2.bn1.bias', 'module.block3.layer.2.bn2.weight', 'module.block3.layer.2.bn2.bias', 'module.block3.layer.3.bn1.weight', 'module.block3.layer.3.bn1.bias', 'module.block3.layer.3.bn2.weight', 'module.block3.layer.3.bn2.bias', 'module.bn1.weight', 'module.bn1.bias']
[24/06/21 11:32:45] [tinyImagenetC_all_resemble.py:  584]: optimizer for adaptation: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00027
    maximize: False
    weight_decay: 0.0
)
[24/06/21 11:33:08] [tinyImagenetC_all_resemble.py:  404]: error % [gaussian_noise5]: 92.54%
